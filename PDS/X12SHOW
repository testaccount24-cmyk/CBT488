
       TITLE '  X12SHOW: explain X12 fields  '.
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    X12SHOW.
      **********************************************************CX003B
      *@@@ C3 explain x12 fields
      ****************************************************************
      *
      *   I am interested in knowing if/where these programs
      *   are used:       Email:  jiannon@me.com
      *
      ****************************************************************
      * Date written: 11/09/2018
      * Author      : Jim Iannone
      *               loop through 80-byte X12 records and
      *               generate field meanings
      *
      *               to find segment in this program, F !seg
      *               ex:   F !ISA
      *
      *          NOTE when adding segments to this program:
      *
      *               in the logic for each segment,
      *               mandatory elements are sent to the conversion
      *               logic without checking if they are blank:
      *
      *               *    data element 717
      *                    MOVE '717'
      *                    MOVE WS-X12-02
      *                    PERFORM 1300-EVALUATE-ELEMENT...
      *
      *               optional elements are checked for blanks:
      *
      *               *    data element 718
      *                    IF WS-X12-03 NOT = SPACE
      *                        MOVE '718'
      *                        MOVE WS-X12-03
      *                        PERFORM 1300-EVALUATE-ELEMENT...
      *
      ****************************************************************
      * Date changed: mm/dd/yyyy username
      *               comments...
      ****************************************************************

       ENVIRONMENT DIVISION.

       CONFIGURATION SECTION.
       SPECIAL-NAMES.
           C01 IS PAGE-TOP.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.

           SELECT X12IN                ASSIGN TO X12IN
                                       ORGANIZATION IS SEQUENTIAL
                                       ACCESS MODE IS SEQUENTIAL
                                       FILE STATUS IS WS-STAT.

           SELECT PARM01               ASSIGN TO PARM01
                                       ORGANIZATION IS SEQUENTIAL
                                       ACCESS MODE IS SEQUENTIAL
                                       FILE STATUS IS WS-STAT.

           SELECT X12OUT               ASSIGN TO X12OUT
                                       ORGANIZATION IS SEQUENTIAL
                                       ACCESS MODE IS SEQUENTIAL
                                       FILE STATUS IS WS-STAT.

       DATA DIVISION.
       FILE SECTION.

       FD  X12IN
           RECORDING MODE F.
       01  X12IN-RECORD.
           05  X12IN-RCD               PIC  X(80).

       FD  PARM01
           RECORDING MODE F.
       01  PARM01-RECORD.
           05  PARM01-DOCU             PIC  X.
           05  FILLER                  PIC  X.
           05  PARM01-ELEMENT          PIC  X(04).
           05  FILLER                  PIC  XX.
           05  PARM01-CODE             PIC  X(06).
           05  FILLER                  PIC  XX.
           05  PARM01-DESC             PIC  X(50).
           05  FILLER                  PIC  X(06).
           05  FILLER                  PIC  X(08).

       FD  X12OUT
           RECORDING MODE F.
       01  X12OUT-RECORD.
           05  X12OUT-RCD              PIC  X(80).

       WORKING-STORAGE SECTION.

       01  WS-START.
           05  FILLER                  PIC  X(32)    VALUE
               ' Working storage X12SHOW start '.

       01  WS-WORK-FIELDS.
           05  WS-STAT                 PIC  99       VALUE ZERO.
           05  WS-VSAM.
               10  WS-VSAM-RETURN      PIC S99       USAGE BINARY.
               10  WS-VSAM-COMPONENT   PIC S9        USAGE BINARY.
               10  WS-VSAM-REASON      PIC S999      USAGE BINARY.
           05  WS-RETURN-CODE          PIC S9(04)    VALUE ZERO COMP.
           05  WS-TALLY                PIC S9(04)    VALUE ZERO COMP.
           05  WS-START-LINE           PIC  9(07)    VALUE ZERO.
           05  WS-PARM01-MAX           PIC  9(05)    VALUE ZERO.
           05  WS-LS-DATA              PIC  X(15)    VALUE SPACE.
           05  FILLER REDEFINES WS-LS-DATA.
               10  WS-LS-LINE          PIC  X(07).
               10  WS-LS-PLANT         PIC  X(08).
           05  WS-X12-RCDS             PIC  X(400)   VALUE SPACE.
           05  WS-X12-RCD              REDEFINES WS-X12-RCDS
                                       OCCURS 5 TIMES
                                       PIC  X(80).
           05  WS-HOLD-SEGMENT         PIC  X(04)    VALUE SPACE.
           05  WS-HOLD-TRAN            PIC  XXX      VALUE SPACE.
           05  WS-HOLD-CODE            PIC  X(06)    VALUE SPACE.
           05  WS-HOLD-1               PIC  X        VALUE SPACE.
           05  WS-HOLD-2               PIC  XX       VALUE SPACE.
           05  WS-HOLD-3               PIC  XXX      VALUE SPACE.
           05  WS-HOLD-48              PIC  X(48)    VALUE SPACE.
           05  WS-X12-SW               PIC  X        VALUE SPACE.
           05  WS-X12-RESET-SW         PIC  X        VALUE SPACE.
           05  WS-SHOW-CNT             PIC  ZZZZZZ9  VALUE ZERO.
           05  WS-HL-CNT               PIC  9(05)    VALUE ZERO.
           05  WS-IT1-CNT              PIC  9(05)    VALUE ZERO.
           05  WS-LIN-CNT              PIC  9(05)    VALUE ZERO.
           05  WS-POC-CNT              PIC  9(05)    VALUE ZERO.
           05  WS-PO1-CNT              PIC  9(05)    VALUE ZERO.
           05  WS-RCD-CNT              PIC  9(05)    VALUE ZERO.
           05  WS-X12-FIELDS.
               10  WS-X12-01           PIC  XXX.
               10  WS-X12-02           PIC  X(80).
               10  FILLER REDEFINES WS-X12-02.
                   15  WS-X12-02-1     PIC  XXX.
                   15  WS-X12-02-2     PIC  XX.
                   15  WS-X12-02-3     PIC  X(75).
               10  WS-X12-03           PIC  X(80).
               10  WS-X12-04           PIC  X(80).
               10  FILLER REDEFINES WS-X12-04.
                   15  WS-X12-04-1     PIC  XXX.
                   15  WS-X12-04-2     PIC  XX.
                   15  WS-X12-04-3     PIC  X(75).
               10  WS-X12-05           PIC  X(80).
               10  FILLER REDEFINES WS-X12-05.
                   15  WS-X12-05-1     PIC  XXX.
                   15  WS-X12-05-2     PIC  XX.
                   15  WS-X12-05-3     PIC  X(75).
               10  WS-X12-06           PIC  X(80).
               10  WS-X12-07           PIC  X(80).
               10  WS-X12-08           PIC  X(80).
               10  WS-X12-09           PIC  X(80).
               10  WS-X12-10           PIC  X(80).
               10  WS-X12-11           PIC  X(80).
               10  WS-X12-12           PIC  X(80).
               10  WS-X12-13           PIC  X(80).
               10  WS-X12-14           PIC  X(80).
               10  WS-X12-15           PIC  X(80).
               10  WS-X12-16           PIC  X(80).
               10  WS-X12-17           PIC  X(80).
               10  WS-X12-18           PIC  X(80).
               10  WS-X12-19           PIC  X(80).
               10  WS-X12-20           PIC  X(80).
               10  WS-X12-21           PIC  X(80).
               10  WS-X12-22           PIC  X(80).
               10  WS-X12-23           PIC  X(80).
               10  WS-X12-24           PIC  X(80).
               10  WS-X12-25           PIC  X(80).
               10  WS-X12-26           PIC  X(80).
               10  WS-X12-27           PIC  X(80).
               10  WS-X12-28           PIC  X(80).
               10  WS-X12-29           PIC  X(80).
               10  WS-X12-30           PIC  X(80).
               10  WS-X12-31           PIC  X(80).
               10  WS-X12-32           PIC  X(80).
           05  WS-EXPLAIN-FIELDS.
               10  WS-GAP              PIC  XXX.
               10  WS-HDR              PIC  X(30).
               10  WS-VALUE            PIC  X(47).
           05  WS-COMPONENT-FIELDS.
               10  WS-COMP-01          PIC  X(40).
               10  WS-COMP-02          PIC  X(40).
               10  WS-COMP-03          PIC  X(40).
               10  WS-COMP-04          PIC  X(40).
               10  WS-COMP-05          PIC  X(40).
               10  WS-COMP-06          PIC  X(40).
      *    DELIMITER
           05  WS-SEG                  PIC  XXX      VALUE SPACE.
           05  WS-DELIM                PIC  X        VALUE SPACE.
           05  WS-COMPONENT-SEP        PIC  X        VALUE SPACE.
           05  WS-EOR                  PIC  X        VALUE SPACE.
           05  WS-EOR-ISA              PIC  X        VALUE SPACE.
           05  WS-EOR-UNB              PIC  X        VALUE SPACE.
           05  WS-X22                  PIC  X        VALUE X'22'.
           05  WS-X0D                  PIC  X        VALUE X'0D'.
           05  WS-X1C                  PIC  X        VALUE X'1C'.
           05  WS-X15                  PIC  X        VALUE X'15'.

       01  WS-COUNT-FIELDS             COMP-3.
           05  WS-READ-X12IN-CNT       PIC S9(07)    VALUE ZERO.
           05  WS-WRITE-X12OUT-CNT     PIC S9(07)    VALUE ZERO.
           05  WS-EOR-RCD-CNT          PIC S9(07)    VALUE ZERO.
           05  WS-ISA-CNT              PIC S9(07)    VALUE ZERO.
           05  WS-UNB-CNT              PIC S9(07)    VALUE ZERO.
           05  WS-ISSUE-CNT            PIC S9(07)    VALUE ZERO.
           05  WS-QUESTION-CNT         PIC S9(07)    VALUE ZERO.
           05  WS-SEGMENT-CNT          PIC S9(07)    VALUE ZERO.

       01  WS-SUBSCRIPTS               COMP.
           05  WS-SUB1                 PIC S9(05)    VALUE ZERO.
           05  WS-SUB2                 PIC S9(05)    VALUE ZERO.
           05  WS-SUB3                 PIC S9(05)    VALUE ZERO.
           05  WS-STR1                 PIC S9(05)    VALUE ZERO.
           05  WS-STR2                 PIC S9(05)    VALUE ZERO.
           05  WS-X12-PTR              PIC S9(05)    VALUE ZERO.

       01  WS-SWITCHES.
           05  WS-END-X12IN-SW         PIC  X        VALUE 'N'.
               88  END-OF-X12IN                      VALUE 'Y'.
               88  MORE-X12IN-RCDS                   VALUE 'N'.
           05  WS-FIRST-RCD-SW         PIC  X        VALUE 'Y'.
               88  FIRST-RECORD                      VALUE 'Y'.
           05  WS-PARM-OVER800-SW      PIC  X        VALUE SPACE.
           05  WS-SEG-OVER10-SW        PIC  X        VALUE SPACE.
           05  WS-ELE-OVER10-SW        PIC  X        VALUE SPACE.
           05  WS-CODE-OVER30-SW       PIC  X        VALUE SPACE.
           05  WS-SHOW-SUMMARY-SW      PIC  X        VALUE SPACE.
           05  WS-START-LINE-SW        PIC  X        VALUE SPACE.
           05  WS-X12PICK-MSG-SW       PIC  X        VALUE SPACE.
           05  WS-COMPONENT-HDR-SW     PIC  X        VALUE SPACE.
      *    these are reset by each ISA
           05  WS-DTM-SW               PIC  X        VALUE SPACE.
           05  WS-FST-SW               PIC  X        VALUE SPACE.
           05  WS-IT1-SW               PIC  X        VALUE SPACE.
           05  WS-JIT-SW               PIC  X        VALUE SPACE.
           05  WS-LIN-SW               PIC  X        VALUE SPACE.
           05  WS-N1-SW                PIC  X        VALUE SPACE.
           05  WS-N2-SW                PIC  X        VALUE SPACE.
           05  WS-N3-SW                PIC  X        VALUE SPACE.
           05  WS-N4-SW                PIC  X        VALUE SPACE.
           05  WS-N9-SW                PIC  X        VALUE SPACE.
           05  WS-PER-SW               PIC  X        VALUE SPACE.
           05  WS-REF-SW               PIC  X        VALUE SPACE.
           05  WS-RMR-SW               PIC  X        VALUE SPACE.
           05  WS-RMT-SW               PIC  X        VALUE SPACE.
           05  WS-SHP-SW               PIC  X        VALUE SPACE.
           05  WS-SLN-SW               PIC  X        VALUE SPACE.
           05  WS-TD1-SW               PIC  X        VALUE SPACE.

       01  WS-TABLES.
           05  WS-PARM01-ITEM          OCCURS 800 TIMES.
               10  WS-P1-ELEMENT       PIC  X(04).
               10  WS-P1-CODE          PIC  X(06).
               10  WS-P1-DESC          PIC  X(50).
           05  WS-SEGMENT-ITEM         OCCURS 10  TIMES.
               10  WS-SI-3             PIC  XXX.
           05  WS-HDR-ITEM             OCCURS 10  TIMES.
               10  WS-HI-30            PIC  X(30).
           05  WS-CODE-ITEM            OCCURS 30  TIMES.
               10  WS-CI-47            PIC  X(47).

       01  WS-END.
           05  FILLER                  PIC  X(16)    VALUE
               '  X12SHOW END  '.

       LINKAGE SECTION.

       01  LS-FIELD.
           05  LS-LENGTH               PIC S9(04)    COMP.
           05  LS-DATA                 PIC  X(15).
           05  FILLER REDEFINES LS-DATA.
               10  LS-LINE             PIC  X(07).
               10  LS-PLANT            PIC  X(08).

      /

       PROCEDURE DIVISION USING LS-FIELD.

       0100-PROGRAM-ENTRY.
           MOVE +0000                         TO WS-RETURN-CODE.
           PERFORM 0200-OPEN-FILES.
           DISPLAY '    '.
           DISPLAY '**** X12SHOW display X12 field meanings'.

           IF WS-RETURN-CODE = ZERO
               PERFORM 0400-PROCESS-X12IN.

           DISPLAY '**** PARM01 items          ' WS-PARM01-MAX
                   ' of 800'.
           IF WS-START-LINE > ZERO
               DISPLAY '**** Limit to ISA on/after ' WS-START-LINE.
           IF WS-ISA-CNT > ZERO
               DISPLAY '**** ISA segments          ' WS-ISA-CNT.
           IF WS-UNB-CNT > ZERO
               DISPLAY '**** UNB segments          ' WS-UNB-CNT.
           IF WS-ISSUE-CNT > ZERO
               DISPLAY '**** X12 data issues       ' WS-ISSUE-CNT.
           IF WS-QUESTION-CNT > ZERO
               DISPLAY '**** Unmatched codes       ' WS-QUESTION-CNT.
           IF WS-SEGMENT-CNT > ZERO
               DISPLAY '**** Unmatched segments    ' WS-SEGMENT-CNT.
           DISPLAY '**** Records in X12IN      ' WS-READ-X12IN-CNT.
           DISPLAY '**** Records written       ' WS-WRITE-X12OUT-CNT.

           IF WS-RETURN-CODE = ZERO
               PERFORM 0300-CLOSE-FILES
           ELSE
               DISPLAY '**** X12SHOW cond code ' WS-RETURN-CODE
                       ' set by program'
               MOVE WS-RETURN-CODE            TO RETURN-CODE.

           DISPLAY '**** X12SHOW EOJ encountered '.
           DISPLAY '    '.
           STOP RUN.

       0200-OPEN-FILES.
           OPEN INPUT  X12IN.
           IF WS-STAT NOT = ZERO
               DISPLAY '**** X12SHOW open error on X12IN'
               DISPLAY '**** File stat           ' WS-STAT
               MOVE +0200                     TO WS-RETURN-CODE.
           OPEN INPUT  PARM01.
           IF WS-STAT NOT = ZERO
               DISPLAY '**** X12SHOW open error on PARM01'
               DISPLAY '**** File stat           ' WS-STAT
               MOVE +0200                     TO WS-RETURN-CODE.
           OPEN OUTPUT X12OUT.
           IF WS-STAT NOT = ZERO
               DISPLAY '**** X12SHOW open error on X12OUT'
               DISPLAY '**** File stat           ' WS-STAT
               MOVE +0200                     TO WS-RETURN-CODE.

       0300-CLOSE-FILES.
           CLOSE X12OUT.
           CLOSE PARM01.
           CLOSE X12IN.

      *---------------------------------------
      *    X
      *---------------------------------------
       0400-PROCESS-X12IN.

           PERFORM 0500-GET-LINKAGE.

           PERFORM VARYING WS-SUB1 FROM 1 BY 1
               UNTIL WS-SUB1 > 800
               MOVE SPACE                     TO WS-P1-ELEMENT(WS-SUB1)
               MOVE SPACE                     TO WS-P1-CODE(WS-SUB1)
               MOVE SPACE                     TO WS-P1-DESC(WS-SUB1)
           END-PERFORM.
           IF WS-RETURN-CODE = ZERO
               MOVE ZERO                      TO WS-SUB1
               PERFORM 0700-LOAD-PARM01 THRU
                       0700-LOAD-PARM01-EXIT.

           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 10
               MOVE SPACE                     TO WS-SI-3(WS-SUB2)
               MOVE SPACE                     TO WS-HI-30(WS-SUB2)
           END-PERFORM.
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 30
               MOVE SPACE                     TO WS-CI-47(WS-SUB2)
           END-PERFORM.

      *---------------------------------------
      *    process primary file
      *---------------------------------------

           MOVE ZERO                          TO WS-X12-PTR.
           MOVE SPACE                         TO WS-X12-RCDS.
           MOVE SPACE                         TO WS-PARM-OVER800-SW.
           MOVE SPACE                         TO WS-SEG-OVER10-SW.
           MOVE SPACE                         TO WS-ELE-OVER10-SW.
           MOVE SPACE                         TO WS-CODE-OVER30-SW.
           MOVE SPACE                         TO WS-X12-SW.
           MOVE SPACE                         TO WS-X12-RESET-SW.
           IF WS-RETURN-CODE = ZERO
               PERFORM 1100-READ-X12IN
                       UNTIL END-OF-X12IN.

           IF WS-RETURN-CODE = ZERO
               PERFORM 0450-SHOW-MSG-IN-FILE.

       0450-SHOW-MSG-IN-FILE.
           IF WS-X12PICK-MSG-SW = 'Y'
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '  Note from program X12SHOW'  TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
           ELSE
           IF WS-QUESTION-CNT > ZERO
               OR WS-SEGMENT-CNT > ZERO
               OR WS-ISSUE-CNT > ZERO
               OR WS-UNB-CNT > ZERO
               OR WS-PARM-OVER800-SW = 'Y'
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Note from program X12SHOW'  TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-X12PICK-MSG-SW = 'Y'
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '  X12PICK found no X12 to pull'  TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-PARM-OVER800-SW = 'Y'
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Parm table has maxed-out'   TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Expand definition beyond 800 elements'
                                                    TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-ISSUE-CNT > ZERO
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Search for $$ to find internal data issues '
                                                    TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE WS-ISSUE-CNT                    TO WS-SHOW-CNT
               MOVE SPACE                           TO X12OUT-RCD
               STRING '!! in unstring file. Issues found       = '
                                                    DELIMITED BY SIZE
                      WS-SHOW-CNT                   DELIMITED BY SIZE
                      INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-QUESTION-CNT > ZERO
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Search for ?? to find unmatched codes'
                                                    TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE WS-QUESTION-CNT                 TO WS-SHOW-CNT
               MOVE SPACE                           TO X12OUT-RCD
               STRING '!! in unstring file. Unmatched code cnt = '
                                                    DELIMITED BY SIZE
                      WS-SHOW-CNT                   DELIMITED BY SIZE
                      INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE SPACE                           TO X12OUT-RCD
               STRING '!! Update values in '        DELIMITED BY SIZE
                      'userid.ISPF.FILE488(X12INPUT)'
                                                    DELIMITED BY SIZE
                      INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-SEGMENT-CNT > ZERO
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Search for X12SHOW to find unmatched segments'
                                                    TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE WS-SEGMENT-CNT                  TO WS-SHOW-CNT
               MOVE SPACE                           TO X12OUT-RCD
               STRING '!! in unstring file. Unmatched seg cnt =  '
                                                    DELIMITED BY SIZE
                      WS-SHOW-CNT                   DELIMITED BY SIZE
                      INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Update segment handling logic in X12SHOW'
                                                    TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-SI-3(1) NOT = SPACE
               PERFORM 0460-SHOW-TOP-SUMMARY
               PERFORM 0460-SHOW-SEGMENTS.
           IF WS-HI-30(1) NOT = SPACE
               PERFORM 0460-SHOW-TOP-SUMMARY
               PERFORM 0460-SHOW-HDR.
           IF WS-CI-47(1) NOT = SPACE
               PERFORM 0460-SHOW-TOP-SUMMARY
               PERFORM 0460-SHOW-CODES.
           IF WS-UNB-CNT > ZERO
               MOVE SPACE                           TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! UNB segments were found in source file'
                                                    TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE WS-UNB-CNT                      TO WS-SHOW-CNT
               MOVE SPACE                           TO X12OUT-RCD
               STRING '!! UNB Segments skipped = '  DELIMITED BY SIZE
                      WS-SHOW-CNT                   DELIMITED BY SIZE
                      INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.

       0460-SHOW-TOP-SUMMARY.
           IF WS-SHOW-SUMMARY-SW = SPACE
               MOVE 'N'                       TO WS-SHOW-SUMMARY-SW
               MOVE SPACE                     TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT
               MOVE '!! Summarized unmatched items:'   TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.

       0460-SHOW-SEGMENTS.
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 10
               IF WS-SI-3(WS-SUB2) NOT = SPACE
                   MOVE SPACE                       TO X12OUT-RCD
                   STRING '!!    Unmatched segment: '
                                                    DELIMITED BY SIZE
                      WS-SI-3(WS-SUB2)              DELIMITED BY SIZE
                      INTO X12OUT-RCD
                   PERFORM 3100-WRITE-X12OUT
               END-IF
           END-PERFORM.
           IF WS-SEG-OVER10-SW = 'Y'
               MOVE '!!    Only 10 segments listed... additional found'
                                              TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.

       0460-SHOW-HDR.
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 10
               IF WS-HI-30(WS-SUB2) NOT = SPACE
                   MOVE SPACE                       TO X12OUT-RCD
                   STRING '!!    Unmatched element: '
                                                    DELIMITED BY SIZE
                      WS-HI-30(WS-SUB2)             DELIMITED BY SIZE
                      INTO X12OUT-RCD
                   PERFORM 3100-WRITE-X12OUT
               END-IF
           END-PERFORM.
           IF WS-ELE-OVER10-SW = 'Y'
               MOVE '!!    Only 10 elements listed... additional found'
                                              TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.

       0460-SHOW-CODES.
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 30
               IF WS-CI-47(WS-SUB2) NOT = SPACE
                   MOVE SPACE                       TO X12OUT-RCD
                   STRING '!!    Unmatched code:    '
                                                    DELIMITED BY SIZE
                      WS-CI-47(WS-SUB2)             DELIMITED BY SIZE
                      INTO X12OUT-RCD
                   PERFORM 3100-WRITE-X12OUT
               END-IF
           END-PERFORM.
           IF WS-CODE-OVER30-SW = 'Y'
               MOVE '!!    Only 30 codes listed... additional found'
                                              TO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.


       0500-GET-LINKAGE.
           IF LS-LENGTH = ZERO
               DISPLAY '**** Parm length is zero '
               MOVE +0500                     TO WS-RETURN-CODE
           ELSE
           IF LS-LENGTH > LENGTH OF WS-LS-DATA
               MOVE LS-DATA(1: LENGTH OF WS-LS-DATA) TO WS-LS-DATA
           ELSE
               MOVE LS-DATA(1: LS-LENGTH)     TO WS-LS-DATA.

           MOVE ZERO                          TO WS-START-LINE.
           MOVE SPACE                         TO WS-START-LINE-SW.
           IF WS-LS-LINE NUMERIC
               MOVE WS-LS-LINE                TO WS-START-LINE
           ELSE
           IF WS-LS-LINE = SPACE
               CONTINUE
           ELSE
               MOVE WS-LS-PLANT(1: 1)         TO WS-LS-PLANT(8: 1)
               MOVE WS-LS-LINE                TO WS-LS-PLANT(1: 7)
               MOVE SPACE                     TO WS-LS-LINE.

           IF WS-LS-PLANT NOT = SPACE
               DISPLAY '**** Plant                 ' WS-LS-PLANT.

      *---------------------------------------
      *    load PARM01  X12 element descriptions
      *---------------------------------------
       0700-LOAD-PARM01.
           READ PARM01.
           IF WS-STAT = 10
               MOVE WS-SUB1                   TO WS-PARM01-MAX
               GO TO 0700-LOAD-PARM01-EXIT
           ELSE
           IF WS-STAT > ZERO
               DISPLAY '**** X12SHOW read error on PARM01'
               DISPLAY '**** File stat = ' WS-STAT
               MOVE +0700                     TO WS-RETURN-CODE
               GO TO 0700-LOAD-PARM01-EXIT.

           IF PARM01-DOCU = '*'
               GO TO 0700-LOAD-PARM01.

           IF WS-SUB1 < 800
               ADD 1                          TO WS-SUB1
               PERFORM 0700-PARM01-FIELDS
           ELSE
               MOVE 'Y'                       TO WS-PARM-OVER800-SW.

           GO TO 0700-LOAD-PARM01.

       0700-LOAD-PARM01-EXIT. EXIT.

       0700-PARM01-FIELDS.
           IF PARM01-ELEMENT = SPACE
               DISPLAY '**** X12SHOW PARM01 element not valued'
               MOVE +0700                     TO WS-RETURN-CODE
           ELSE
               MOVE PARM01-ELEMENT         TO WS-P1-ELEMENT(WS-SUB1).
           MOVE PARM01-CODE                TO WS-P1-CODE(WS-SUB1).
           IF PARM01-DESC = SPACE
               DISPLAY '**** X12SHOW PARM01 description not valued'
               MOVE +0700                     TO WS-RETURN-CODE
           ELSE
               MOVE PARM01-DESC            TO WS-P1-DESC(WS-SUB1).

      *---------------------------------------

       1100-READ-X12IN.
           READ X12IN.
           IF WS-STAT = ZERO
               ADD 1                          TO WS-READ-X12IN-CNT
               PERFORM 1200-SELECT THRU
                       1200-SELECT-EXIT
           ELSE
           IF WS-STAT = 10
               MOVE 'Y'                       TO WS-END-X12IN-SW
           ELSE
               DISPLAY '**** X12SHOW read error on X12IN '
               DISPLAY '**** File stat           ' WS-STAT
               MOVE +1100                     TO WS-RETURN-CODE.

      *---------------------------------------
      *    When ISA or UNB encountered, determine EOR character
      *    and field delimiter.  Stack multi-line records such as
      *    ISA or some LIN segments into WS-X12-RCDS so they can
      *    be manipulated as one greater-than-80 character record.
      *----+----------------------------------
       1200-SELECT.
           IF WS-X12-RESET-SW = 'Y'
               MOVE SPACE                     TO WS-X12-SW
               MOVE SPACE                     TO WS-X12-RESET-SW.

           IF X12IN-RCD(1: 3) = 'ISA'
               ADD 1                          TO WS-ISA-CNT
               MOVE ZERO                      TO WS-EOR-RCD-CNT
               MOVE 'X'                       TO WS-X12-SW.
           IF X12IN-RCD(1: 3) = 'UNB'
               ADD 1                          TO WS-UNB-CNT
               MOVE ZERO                      TO WS-EOR-RCD-CNT
               MOVE 'E'                       TO WS-X12-SW.

      *    if starting line specified, only select next occurring ISA
           IF WS-START-LINE > ZERO
             IF WS-READ-X12IN-CNT < WS-START-LINE
                 GO TO 1200-SELECT-EXIT
             ELSE
             IF WS-X12-SW = SPACE
                 GO TO 1200-SELECT-EXIT
             ELSE
             IF X12IN-RCD(1: 3) = 'ISA'
               IF WS-START-LINE-SW = SPACE
                   MOVE 'Y'                   TO WS-START-LINE-SW
               ELSE
                   GO TO 1200-SELECT-EXIT
             ELSE
             IF WS-START-LINE-SW = 'N' OR SPACE
                 GO TO 1200-SELECT-EXIT
             ELSE
             IF X12IN-RCD(1: 3) = 'IEA'
                 MOVE 'N'                     TO WS-START-LINE-SW.

           IF X12IN-RCD(1: 3) = 'IEA' OR 'UNZ'
               MOVE 'Y'                       TO WS-X12-RESET-SW.

           IF X12IN-RCD = '!! Note from program X12PICK '
               MOVE 'Y'                       TO WS-X12PICK-MSG-SW
               MOVE 'Y'                       TO WS-END-X12IN-SW.

      *    skip processing UNB segments until logic added
      *    to program
           IF WS-X12-SW NOT = 'X'
               GO TO 1200-SELECT-EXIT.

           ADD 1                              TO WS-EOR-RCD-CNT.
           IF WS-X12-SW NOT = SPACE
             IF WS-X12-PTR < 5
                 ADD 1                        TO WS-X12-PTR.

           IF WS-X12-SW NOT = SPACE
               MOVE X12IN-RCD                 TO WS-X12-RCD(WS-X12-PTR).

           IF WS-X12-SW = 'E'
             IF WS-EOR-RCD-CNT = 1
                 PERFORM 2600-DETERMINE-EOR-UNB
                 PERFORM 1200-DETERMINE-MULTI-LINE
             ELSE
                 PERFORM 1200-DETERMINE-MULTI-LINE
           ELSE
           IF WS-X12-SW = 'X'
             IF WS-EOR-RCD-CNT = 1
                 CONTINUE
             ELSE
             IF WS-EOR-RCD-CNT = 2
                 PERFORM 2600-DETERMINE-EOR-ISA
                 PERFORM 1200-DETERMINE-MULTI-LINE
             ELSE
                 PERFORM 1200-DETERMINE-MULTI-LINE.

       1200-SELECT-EXIT. EXIT.

       1200-DETERMINE-MULTI-LINE.
           MOVE ZERO                          TO WS-TALLY.
           INSPECT WS-X12-RCDS TALLYING WS-TALLY FOR ALL WS-EOR.
           IF WS-TALLY NOT = ZERO
               PERFORM 1250-SELECT-DELIM
               MOVE SPACE                     TO WS-X12-RCDS
               MOVE ZERO                      TO WS-X12-PTR.

       1250-SELECT-DELIM.
           IF WS-DELIM = SPACE
               DISPLAY '**** X12SHOW rcd delimiter undetermined'
               DISPLAY '**** terminating program'
               MOVE 'Y'                       TO WS-END-X12IN-SW
           ELSE
           IF WS-X12-RCDS(3: 1) = WS-DELIM
               PERFORM 1250-SELECT-2
           ELSE
           IF WS-X12-RCDS(4: 1) = WS-DELIM
               PERFORM 1250-SELECT-3.

      *    !seg
       1250-SELECT-2.
           MOVE WS-X12-RCDS(1: 2)             TO WS-SEG.
           EVALUATE WS-SEG
             WHEN 'B1 '    PERFORM 1300-UNSTRING-B1
             WHEN 'GE '    PERFORM 1300-UNSTRING-GE
             WHEN 'GS '    PERFORM 1300-UNSTRING-GS
             WHEN 'HL '    PERFORM 1300-UNSTRING-HL
             WHEN 'LE '    PERFORM 1300-UNSTRING-LE-LS
             WHEN 'LS '    PERFORM 1300-UNSTRING-LE-LS
             WHEN 'LX '    PERFORM 1300-UNSTRING-LX
             WHEN 'N1 '    PERFORM 1300-UNSTRING-N1
             WHEN 'N2 '    PERFORM 1300-UNSTRING-N2
             WHEN 'N3 '    PERFORM 1300-UNSTRING-N3
             WHEN 'N4 '    PERFORM 1300-UNSTRING-N4
             WHEN 'N9 '    PERFORM 1300-UNSTRING-N9
             WHEN 'SE '    PERFORM 1300-UNSTRING-SE
             WHEN 'ST '    PERFORM 1300-UNSTRING-ST
             WHEN OTHER    PERFORM 1300-DISPLAY-OTHER
           END-EVALUATE.

       1250-SELECT-3.
           MOVE WS-X12-RCDS(1: 3)             TO WS-SEG.
           EVALUATE WS-SEG
             WHEN 'ADX'    PERFORM 1300-UNSTRING-ADX
             WHEN 'AK1'    PERFORM 1300-UNSTRING-AK1
             WHEN 'AK2'    PERFORM 1300-UNSTRING-AK2
             WHEN 'AK3'    PERFORM 1300-UNSTRING-AK3
             WHEN 'AK4'    PERFORM 1300-UNSTRING-AK4
             WHEN 'AK5'    PERFORM 1300-UNSTRING-AK5
             WHEN 'AK9'    PERFORM 1300-UNSTRING-AK9
             WHEN 'AMT'    PERFORM 1300-UNSTRING-AMT
             WHEN 'ATH'    PERFORM 1300-UNSTRING-ATH
             WHEN 'BCH'    PERFORM 1300-UNSTRING-BCH
             WHEN 'BCT'    PERFORM 1300-UNSTRING-BCT
             WHEN 'BEG'    PERFORM 1300-UNSTRING-BEG
             WHEN 'BFR'    PERFORM 1300-UNSTRING-BFR
             WHEN 'BGN'    PERFORM 1300-UNSTRING-BGN
             WHEN 'BIA'    PERFORM 1300-UNSTRING-BIA
             WHEN 'BIG'    PERFORM 1300-UNSTRING-BIG
             WHEN 'BMG'    PERFORM 1300-UNSTRING-BMG
             WHEN 'BPR'    PERFORM 1300-UNSTRING-BPR
             WHEN 'BPS'    PERFORM 1300-UNSTRING-BPS
             WHEN 'BRA'    PERFORM 1300-UNSTRING-BRA
             WHEN 'BSN'    PERFORM 1300-UNSTRING-BSN
             WHEN 'BSS'    PERFORM 1300-UNSTRING-BSS
             WHEN 'CLD'    PERFORM 1300-UNSTRING-CLD
             WHEN 'CTP'    PERFORM 1300-UNSTRING-CTP
             WHEN 'CTT'    PERFORM 1300-UNSTRING-CTT
             WHEN 'CUR'    PERFORM 1300-UNSTRING-CUR
             WHEN 'DTM'    PERFORM 1300-UNSTRING-DTM
             WHEN 'ENT'    PERFORM 1300-UNSTRING-ENT
             WHEN 'ETD'    PERFORM 1300-UNSTRING-ETD
             WHEN 'FOB'    PERFORM 1300-UNSTRING-FOB
             WHEN 'FST'    PERFORM 1300-UNSTRING-FST
             WHEN 'IEA'    PERFORM 1300-UNSTRING-IEA
             WHEN 'ISA'    PERFORM 1300-UNSTRING-ISA
             WHEN 'IT1'    PERFORM 1300-UNSTRING-IT1
             WHEN 'ITA'    PERFORM 1300-UNSTRING-ITA
             WHEN 'ITD'    PERFORM 1300-UNSTRING-ITD
             WHEN 'JIT'    PERFORM 1300-UNSTRING-JIT
             WHEN 'J2X'    PERFORM 1300-UNSTRING-J2X
             WHEN 'LIN'    PERFORM 1300-UNSTRING-LIN
             WHEN 'MAN'    PERFORM 1300-UNSTRING-MAN
             WHEN 'MEA'    PERFORM 1300-UNSTRING-MEA
             WHEN 'MIT'    PERFORM 1300-UNSTRING-MIT
             WHEN 'MSG'    PERFORM 1300-UNSTRING-MSG
             WHEN 'MTX'    PERFORM 1300-UNSTRING-MTX
             WHEN 'NM1'    PERFORM 1300-UNSTRING-NM1
             WHEN 'NTE'    PERFORM 1300-UNSTRING-NTE
             WHEN 'OTI'    PERFORM 1300-UNSTRING-OTI
             WHEN 'PER'    PERFORM 1300-UNSTRING-PER
             WHEN 'PID'    PERFORM 1300-UNSTRING-PID
             WHEN 'PKG'    PERFORM 1300-UNSTRING-PKG
             WHEN 'POC'    PERFORM 1300-UNSTRING-POC
             WHEN 'PRF'    PERFORM 1300-UNSTRING-PRF
             WHEN 'PRR'    PERFORM 1300-UNSTRING-PRR
             WHEN 'PRS'    PERFORM 1300-UNSTRING-PRS
             WHEN 'PO1'    PERFORM 1300-UNSTRING-PO1
             WHEN 'PO4'    PERFORM 1300-UNSTRING-PO4
             WHEN 'QTY'    PERFORM 1300-UNSTRING-QTY
             WHEN 'RCD'    PERFORM 1300-UNSTRING-RCD
             WHEN 'REF'    PERFORM 1300-UNSTRING-REF
             WHEN 'REP'    PERFORM 1300-UNSTRING-REP
             WHEN 'RMR'    PERFORM 1300-UNSTRING-RMR
             WHEN 'RMT'    PERFORM 1300-UNSTRING-RMT
             WHEN 'SAC'    PERFORM 1300-UNSTRING-SAC
             WHEN 'SCH'    PERFORM 1300-UNSTRING-SCH
             WHEN 'SDP'    PERFORM 1300-UNSTRING-SDP
             WHEN 'SHP'    PERFORM 1300-UNSTRING-SHP
             WHEN 'SLN'    PERFORM 1300-UNSTRING-SLN
             WHEN 'SN1'    PERFORM 1300-UNSTRING-SN1
             WHEN 'SSS'    PERFORM 1300-UNSTRING-SSS
             WHEN 'TAX'    PERFORM 1300-UNSTRING-TAX
             WHEN 'TA1'    PERFORM 1300-UNSTRING-TA1
             WHEN 'TDS'    PERFORM 1300-UNSTRING-TDS
             WHEN 'TD1'    PERFORM 1300-UNSTRING-TD1
             WHEN 'TD3'    PERFORM 1300-UNSTRING-TD3
             WHEN 'TD4'    PERFORM 1300-UNSTRING-TD4
             WHEN 'TD5'    PERFORM 1300-UNSTRING-TD5
             WHEN 'TED'    PERFORM 1300-UNSTRING-TED
             WHEN 'TRN'    PERFORM 1300-UNSTRING-TRN
             WHEN 'TXI'    PERFORM 1300-UNSTRING-TXI
             WHEN 'UNT'
             WHEN 'UIT'    PERFORM 1300-UNSTRING-UIT
             WHEN OTHER    PERFORM 1300-DISPLAY-OTHER
           END-EVALUATE.

       1300-DISPLAY-OTHER.
           MOVE 'X12SHOW program not yet setup for segment:'
                                              TO X12OUT-RCD.
           PERFORM 3100-WRITE-X12OUT.
           PERFORM 1800-SHOW-X12-OUT.
           ADD 1                              TO WS-SEGMENT-CNT.

      *---------------------------------------
      *    add unmatched segments to table and list at end
      *---------------------------------------
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 11
               IF WS-SUB2 > 10
                   MOVE 'Y'                   TO WS-SEG-OVER10-SW
               ELSE
               IF WS-SEG = WS-SI-3(WS-SUB2)
                   MOVE 11                    TO WS-SUB2
               ELSE
               IF WS-SI-3(WS-SUB2) = SPACE
                   MOVE WS-SEG                TO WS-SI-3(WS-SUB2)
                   MOVE 11                    TO WS-SUB2
               END-IF
               END-IF
               END-IF
           END-PERFORM.


      *---------------------------------------

      *    !ADX
      *    ADX*0*01*OI*34074064~
       1300-UNSTRING-ADX.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ADX'                         TO WS-HDR.
           MOVE 'Adjustment'                  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Monetary amount'             TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 426
           MOVE '426'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-X12-04 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !AK1
      *    AK1*SH*1957~
       1300-UNSTRING-AK1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AK1'                         TO WS-HDR.
           MOVE 'Functional group response hdr'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 479
           MOVE '479'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Group control number'        TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !AK2
      *    AK2*856*1957001~
       1300-UNSTRING-AK2.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AK2'                         TO WS-HDR.
           MOVE 'Transaction set response hdr'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 143
           MOVE '143'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Transaction control number'  TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !AK3
      *    AK3~TD5~9
       1300-UNSTRING-AK3.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AK3'                         TO WS-HDR.
           MOVE 'Data segment note'           TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Segment ID code'             TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Segment position'            TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Loop identified code'    TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 720
           IF WS-X12-05 NOT = SPACE
               MOVE '720'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !AK4
      *    AK4~4~0091~10
       1300-UNSTRING-AK4.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AK4'                         TO WS-HDR.
           MOVE 'Data element note'           TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element C030
           MOVE 'Position in segment'         TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Data element ref nbr'    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 723
           IF WS-X12-04 NOT = SPACE
               MOVE '723'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Copy of bad data'        TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !AK5
      *    AK5*A~
       1300-UNSTRING-AK5.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AK5'                         TO WS-HDR.
           MOVE 'Transaction set response trailer'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 717
           MOVE '717'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 718
           IF WS-X12-03 NOT = SPACE
               MOVE '718'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE '718'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE '718'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE '718'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE '718'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !AK9
      *    AK9*A*1*1*1~
       1300-UNSTRING-AK9.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AK9'                         TO WS-HDR.
           MOVE 'Functional group response trailer'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 715
           MOVE '715'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Number of transaction sets'  TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Nbr of received trans sets'  TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Nbr of accepted trans sets'  TO WS-HDR.
           MOVE WS-X12-05                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE '716'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE '716'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE '716'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE '716'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE '716'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !AMT
      *    AMT*CC*5.45.
       1300-UNSTRING-AMT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'AMT'                         TO WS-HDR.
           MOVE 'Monetary amount'             TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 522
           MOVE '522'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Monetary amount'             TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 478
           IF WS-X12-04 NOT = SPACE
               MOVE '478'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !ATH
      *    ATH*MT*181222*1428**181123
       1300-UNSTRING-ATH.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ATH'                         TO WS-HDR.
           MOVE 'Resource authorization'      TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 672
           MOVE '672'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !BCH
      *    BCH*18*BK*4300261028***180126.
       1300-UNSTRING-BCH.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BCH'                         TO WS-HDR.
           MOVE 'Begin segment for purch order change' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 92
           MOVE '92'                          TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Purchase order number'       TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Release number'          TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Change order seq nbr'    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-07                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Request reference number'   TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Contract number'         TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1166
           IF WS-X12-13 NOT = SPACE
               MOVE '1166'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 786
           IF WS-X12-14 NOT = SPACE
               MOVE '786'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 587
           IF WS-X12-15 NOT = SPACE
               MOVE '587'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-16 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-16                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1232
           IF WS-X12-17 NOT = SPACE
               MOVE '1232'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-17                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BCT
      *    BCT*PC*********04~
       1300-UNSTRING-BCT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BCT'                         TO WS-HDR.
           MOVE 'Begin segment price sales catalog' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 683
           MOVE '683'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Catalog number'          TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Catalog version number'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Catalog revision number' TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-06 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Catalog number'          TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Catalog version number'  TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Catalog revision number' TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           IF WS-X12-11 NOT = SPACE
               MOVE '353'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BEG
      *    BEG*00*NE*ST-R645559**20181119**AC~
       1300-UNSTRING-BEG.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BEG'                         TO WS-HDR.
           MOVE 'Beginning segment for purchase order'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 92
           MOVE '92'                          TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Purchase order number'       TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Release number'          TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-06                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Contract number'         TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 587
           IF WS-X12-08 NOT = SPACE
               MOVE '587'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1019
           IF WS-X12-09 NOT = SPACE
               MOVE '1019'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1166
           IF WS-X12-10 NOT = SPACE
               MOVE '1166'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1232
           IF WS-X12-11 NOT = SPACE
               MOVE '1232'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 786
           IF WS-X12-12 NOT = SPACE
               MOVE '786'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-13 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BFR
      *    BFR*00**171113*DL*A*171113*171130*171113**CP
       1300-UNSTRING-BFR.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BFR'                         TO WS-HDR.
           MOVE 'Planning schedule beginning segment'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Release number'          TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 675
           MOVE '675'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-05                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 676
           MOVE '676'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-06                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Contract number'         TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Purchase order number'   TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 783
           IF WS-X12-13 NOT = SPACE
               MOVE '783'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 306
           IF WS-X12-14 NOT = SPACE
               MOVE '306'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BGN
      *    BGN*00*17100000001*171109.
       1300-UNSTRING-BGN.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BGN'                         TO WS-HDR.
           MOVE 'Beginning segment'           TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference identification'    TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 623
           IF WS-X12-06 NOT = SPACE
               MOVE '623'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-08 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 306
           IF WS-X12-09 NOT = SPACE
               MOVE '306'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 786
           IF WS-X12-10 NOT = SPACE
               MOVE '786'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BIA
      *    BIA~00~01~6928560~20181127
       1300-UNSTRING-BIA.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BIA'                         TO WS-HDR.
           MOVE 'Begin seg inventory inq/advice' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 755
           MOVE '755'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference identification'    TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-05                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 306
           IF WS-X12-07 NOT = SPACE
               MOVE '306'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BIG
      *    BIG*20171201*Q3639HD*****DI.
       1300-UNSTRING-BIG.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BIG'                         TO WS-HDR.
           MOVE 'Beginning segment for invoice'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Invoice number'              TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Purchase order number'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Release number'          TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Change order seq number' TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-03 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           IF WS-X12-09 NOT = SPACE
               MOVE '353'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 306
           IF WS-X12-10 NOT = SPACE
               MOVE '306'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Invoice number'          TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !BMG
      *    BMG*00*SUPPLIERMEMO.
       1300-UNSTRING-BMG.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BMG'                         TO WS-HDR.
           MOVE 'Beginning segment for text message'    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-04 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BPR
      *    BPR~I~155956.34~C~ZZZ~~~~~~~~01~026009674~~807005~181106.
       1300-UNSTRING-BPR.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BPR'                         TO WS-HDR.
           MOVE 'Begin segment payment order/remittance' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 305
           MOVE '305'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Monetary amount'             TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 478
           MOVE '478'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 591
           MOVE '591'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-05                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 812
           IF WS-X12-06 NOT = SPACE
               MOVE '812'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 506
           IF WS-X12-07 NOT = SPACE
               MOVE '506'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'DFI identification nbr'  TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 569
           IF WS-X12-09 NOT = SPACE
               MOVE '569'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Account number'          TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Originating company id'  TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Originating co supplement cd' TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 506
           IF WS-X12-13 NOT = SPACE
               MOVE '506'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-14 NOT = SPACE
               MOVE 'DFI identification nbr'  TO WS-HDR
               MOVE WS-X12-14                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 569
           IF WS-X12-15 NOT = SPACE
               MOVE '569'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Account number'          TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-17 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-17                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-18 NOT = SPACE
               MOVE 'Business function code'  TO WS-HDR
               MOVE WS-X12-18                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 506
           IF WS-X12-19 NOT = SPACE
               MOVE '506'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-19                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-20 NOT = SPACE
               MOVE 'DFI identification nbr'  TO WS-HDR
               MOVE WS-X12-20                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 569
           IF WS-X12-21 NOT = SPACE
               MOVE '569'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-21                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-22 NOT = SPACE
               MOVE 'Account number'          TO WS-HDR
               MOVE WS-X12-22                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !BPS
      *    BPS*PBC*43514.48*I********1119900*171112.
       1300-UNSTRING-BPS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BPS'                         TO WS-HDR.
           MOVE 'Beginning segment header'    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element unknown - from web
           IF WS-X12-02 NOT = SPACE
               MOVE 'BPS1'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element unknown - from web
           IF WS-X12-04 NOT = SPACE
               MOVE 'BPS2'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BRA
      *    BRA*EPS1107NSG3*20181107*00*2~
       1300-UNSTRING-BRA.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BRA'                         TO WS-HDR.
           MOVE 'Beginning segment receiving advice'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference identification'    TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 962
           MOVE '962'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-05                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 412
           IF WS-X12-07 NOT = SPACE
               MOVE '412'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 306
           IF WS-X12-08 NOT = SPACE
               MOVE '306'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BSN
      *    BSN*00*00200877*20181112*0951~
       1300-UNSTRING-BSN.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BSN'                         TO WS-HDR.
           MOVE 'Ship notice beginning segment' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Shipment identification'     TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Time'                        TO WS-HDR.
           MOVE WS-X12-05                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 1005
           IF WS-X12-06 NOT = SPACE
               MOVE '1005'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-07 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 641
           IF WS-X12-08 NOT = SPACE
               MOVE '641'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !BSS
      *    BSS~05~183120000603~181108~SH~181108~181121~862-24~~~~C
       1300-UNSTRING-BSS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'BSS'                         TO WS-HDR.
           MOVE 'Shipping schedule beginning segment' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           MOVE '353'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference identification'    TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 675
           MOVE '675'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-05                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-06                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-07                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Release number'          TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Contract number'         TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Purchase order/reference nbr' TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 676
           IF WS-X12-12 NOT = SPACE
               MOVE '676'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !B1
      *    B1*HUBG*001471167*181115*A~
       1300-UNSTRING-B1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'B1'                          TO WS-HDR.
           MOVE 'Beginning segment for booking' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Standard carrier alpha cd'  TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Shipment identification nbr' TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 558
           IF WS-X12-05 NOT = SPACE
               MOVE '558'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !CLD
      *    CLD*1*20*PCS71@
       1300-UNSTRING-CLD.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'CLD'                         TO WS-HDR.
           MOVE 'Load Detail'                 TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Number of loads'             TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Number of units shipped'     TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 103
           IF WS-X12-04-1 NOT = SPACE
               MOVE '103A'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-04-1               TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04-2 NOT = SPACE
               MOVE '103B'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-04-2               TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Size'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-06 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !CTP
      *    CTP**CAT*4.842*1*EA~
       1300-UNSTRING-CTP.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'CTP'                         TO WS-HDR.
           MOVE 'Pricing information'         TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 687
           IF WS-X12-02 NOT = SPACE
               MOVE '687'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 236
           IF WS-X12-03 NOT = SPACE
               MOVE '236'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Unit price'              TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 648
           IF WS-X12-07 NOT = SPACE
               MOVE '648'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Multiplier'              TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 639
           IF WS-X12-10 NOT = SPACE
               MOVE '639'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Condition value'         TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Multiple price quantity' TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !CTT
      *    CTT~6~649440
       1300-UNSTRING-CTT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'CTT'                         TO WS-HDR.
           MOVE 'Transaction totals'          TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Number of line items'        TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Hash total'              TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           PERFORM 2100-SHOW-CTT-TOTALS.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Weight'                  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-05 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Volume'                  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-07 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

       2100-SHOW-CTT-TOTALS.
           IF WS-HOLD-TRAN = '810'
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   (Calculated nbr '   DELIMITED BY SIZE
                       WS-HOLD-TRAN           DELIMITED BY SIZE
                      ' IT1 items)   '        DELIMITED BY SIZE
                       WS-IT1-CNT             DELIMITED BY SIZE
                       INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-HOLD-TRAN = '830' OR '846' OR '862'
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   (Calculated nbr '   DELIMITED BY SIZE
                       WS-HOLD-TRAN           DELIMITED BY SIZE
                      ' LIN items)   '        DELIMITED BY SIZE
                       WS-LIN-CNT             DELIMITED BY SIZE
                       INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-HOLD-TRAN = '850'
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   (Calculated nbr '   DELIMITED BY SIZE
                       WS-HOLD-TRAN           DELIMITED BY SIZE
                      ' PO1 items)   '        DELIMITED BY SIZE
                       WS-PO1-CNT             DELIMITED BY SIZE
                       INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-HOLD-TRAN = '856'
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   (Calculated nbr '   DELIMITED BY SIZE
                       WS-HOLD-TRAN           DELIMITED BY SIZE
                      ' HL items)    '        DELIMITED BY SIZE
                       WS-HL-CNT              DELIMITED BY SIZE
                       INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-HOLD-TRAN = '860'
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   (Calculated nbr '   DELIMITED BY SIZE
                       WS-HOLD-TRAN           DELIMITED BY SIZE
                      ' POC items)   '        DELIMITED BY SIZE
                       WS-POC-CNT             DELIMITED BY SIZE
                       INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.
           IF WS-HOLD-TRAN = '861'
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   (Calculated nbr '   DELIMITED BY SIZE
                       WS-HOLD-TRAN           DELIMITED BY SIZE
                      ' RCD items)   '        DELIMITED BY SIZE
                       WS-RCD-CNT             DELIMITED BY SIZE
                       INTO X12OUT-RCD
               PERFORM 3100-WRITE-X12OUT.

      *    !CUR
      *    CUR~BY~USD.
       1300-UNSTRING-CUR.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'CUR'                         TO WS-HDR.
           MOVE 'Currency'                    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           MOVE '98'                          TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Currency code'               TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Exchange rate'           TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           IF WS-X12-05 NOT = SPACE
               MOVE '98'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Currency code'           TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 669
           IF WS-X12-07 NOT = SPACE
               MOVE '669'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-08 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-11 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-13 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-13                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-14 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-15 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-15                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-17 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-17                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-18 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-18                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-19 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-19                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-20 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-20                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-21 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-21                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-22 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-22                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !DTM
      *    DTM*011*20181112*0943~
       1300-UNSTRING-DTM.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-DTM-SW = SPACE
               MOVE 'N'                       TO WS-DTM-SW
               MOVE 'DTM'                     TO WS-HDR
               MOVE 'Date/time reference'     TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           MOVE '374'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 623
           IF WS-X12-05 NOT = SPACE
               MOVE '623'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1250
           IF WS-X12-06 NOT = SPACE
               MOVE 'Period format qualifier' TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Date time period'        TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !ENT
      *    ENT~1.
       1300-UNSTRING-ENT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ENT'                         TO WS-HDR.
           MOVE 'Entity'                      TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned number'         TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           IF WS-X12-03 NOT = SPACE
               MOVE '98'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 66
           IF WS-X12-04 NOT = SPACE
               MOVE '66'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Identification code'     TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           IF WS-X12-06 NOT = SPACE
               MOVE '98'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 66
           IF WS-X12-07 NOT = SPACE
               MOVE '66'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Identification code'     TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-X12-09 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !ETD
      *    ETD*ZZ*A*AE*CE434298~
       1300-UNSTRING-ETD.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ETD'                         TO WS-HDR.
           MOVE 'Excess transportation detail'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 626
           MOVE '626'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 627
           MOVE '627'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-X12-04 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 743
           IF WS-X12-06 NOT = SPACE
               MOVE '743'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !FOB
      *    FOB*FO.
       1300-UNSTRING-FOB.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'FOB'                         TO WS-HDR.
           MOVE 'FOB related instructions'    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 146
           MOVE '146'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-03 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 334
           IF WS-X12-05 NOT = SPACE
               MOVE '334'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 335
           IF WS-X12-06 NOT = SPACE
               MOVE '335'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-07 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 54
           IF WS-X12-09 NOT = SPACE
               MOVE '54'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !FST
      *    FST~20320~C~D~181120~~010~0800.
       1300-UNSTRING-FST.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-FST-SW = SPACE
               MOVE 'N'                       TO WS-FST-SW
               MOVE 'FST'                     TO WS-HDR
               MOVE 'Forecast schedule'       TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Quantity'                    TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 680
           MOVE '680'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 681
           MOVE '681'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-05                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06(1: 2) NOT = SPACE
             IF WS-X12-06(3: 5) = SPACE
                 PERFORM 1300-FST-PO-NUMBER
             ELSE
                 PERFORM 1300-FST-REGULAR
           ELSE
               PERFORM 1300-FST-REGULAR.

       1300-FST-REGULAR.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-07 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-X12-09 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 783
           IF WS-X12-11 NOT = SPACE
               MOVE '783'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

       1300-FST-PO-NUMBER.
      *    data element 128
           IF WS-X12-06 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Purchase order number'   TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-X12-09 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 783
           IF WS-X12-11 NOT = SPACE
               MOVE '783'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !GE
      *    GE~1~000005118.
       1300-UNSTRING-GE.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'GE'                          TO WS-HDR.
           MOVE 'Functional group trailer'    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Number of transaction sets'  TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Group control number'        TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !GS
      *    GS~SS~AP20A~L340U~181108~0510~000005118~X~002002FORD
       1300-UNSTRING-GS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'GS'                          TO WS-HDR.
           MOVE 'Functional group header'     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 479
           MOVE '479'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Application senders code'    TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Application receivers code'  TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Group control number'    TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 455
           IF WS-X12-08 NOT = SPACE
               MOVE '455'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Version/release/industry code' TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !HL
      *    HL*3*2*I*0~
       1300-UNSTRING-HL.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           ADD 1                              TO WS-HL-CNT.
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'HL'                          TO WS-HDR.
           MOVE 'Hierarchical level'          TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Hierarchical ID number'      TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Hierarchical parent ID nbr' TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 735
           MOVE '735'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 736
           IF WS-X12-05 NOT = SPACE
               MOVE '736'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !IEA
      *    IEA~00001~000005118
       1300-UNSTRING-IEA.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'IEA'                         TO WS-HDR.
           MOVE 'Interchange control trailer' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Included functional groups'  TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange control number'  TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !ISA
      *    ISA~00~          ~00~          ~ZZ~F159B          ~ZZ~L340U
       1300-UNSTRING-ISA.
           MOVE SPACE                         TO WS-DTM-SW  WS-FST-SW
                                                 WS-IT1-SW  WS-JIT-SW
                                                 WS-LIN-SW
                                                 WS-N1-SW   WS-N2-SW
                                                 WS-N3-SW   WS-N4-SW
                                                 WS-N9-SW
                                                 WS-PER-SW  WS-REF-SW
                                                 WS-RMR-SW
                                                 WS-RMT-SW  WS-SHP-SW
                                                 WS-SLN-SW  WS-TD1-SW.
           MOVE SPACE                         TO WS-HOLD-TRAN.
           PERFORM 1800-SHOW-X12-OUT.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17.

           MOVE SPACE                         TO WS-X12-17(2: 1).
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ISA'                         TO WS-HDR.
           MOVE 'Interchange control header'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I01 pg 1558
           MOVE 'I01'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = '00'
               MOVE 'Authorization information'  TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element I03 pg 1558
      *    allow blank security info even if code not '00'
           MOVE 'I03'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 = '00'
               CONTINUE
           ELSE
           IF WS-X12-05 = SPACE
               CONTINUE
           ELSE
               MOVE 'Security information'    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element I05 pg 1558
           MOVE 'I05'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-06                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange sender ID'       TO WS-HDR.
           MOVE WS-X12-07                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I05 pg 1558
           MOVE 'I05'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-08                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange receiver ID'     TO WS-HDR.
           MOVE WS-X12-09                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange date'            TO WS-HDR.
           MOVE WS-X12-10                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange time'            TO WS-HDR.
           MOVE WS-X12-11                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I10   pg 1558
           MOVE 'I10'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-12                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I11  page 1560
           MOVE 'I11'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-13                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange control number'  TO WS-HDR.
           MOVE WS-X12-14                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I13  page 1560
           MOVE 'I13'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-15                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I14  page 1560
           MOVE 'I14'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-16                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Component element separator' TO WS-HDR.
           MOVE WS-X12-17                     TO WS-VALUE.
           MOVE WS-X12-17                     TO WS-COMPONENT-SEP.
           PERFORM 3000-BUILD-X12OUT.

      *    !ITA
      *    ITA~C~~~06~~~107000~~~~~~CUR.REC.TAX AUTH-IND.TA
       1300-UNSTRING-ITA.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ITA'                         TO WS-HDR.
           MOVE 'Allowance, charge or service'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 248
           MOVE '248'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-03 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 560
           IF WS-X12-04 NOT = SPACE
               MOVE '560'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 331
           MOVE '331'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-05                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Allowance or charge nbr' TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Allowance or charge rate'   TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Allowance or charge amount' TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 378
           IF WS-X12-09 NOT = SPACE
               MOVE '378'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Percent'                 TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-12 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-13 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-13                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-14 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-14                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 150
           IF WS-X12-15 NOT = SPACE
               MOVE '150'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 662
           IF WS-X12-17 NOT = SPACE
               MOVE '662'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-17                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-18 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-18                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !ITD
      *    ITD*09*OR.
       1300-UNSTRING-ITD.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ITD'                         TO WS-HDR.
           MOVE 'Terms of sale/deferred terms of sale' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 336
           IF WS-X12-02 NOT = SPACE
               MOVE '336'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 333
           IF WS-X12-03 NOT = SPACE
               MOVE '333'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Terms discount percent'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Terms discount due date' TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Terms discount days due' TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Terms net due date'      TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Terms net days'          TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Terms discount amount'   TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Terms deferred due date' TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Deferred amount due'     TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Percent invoice payable' TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-13 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-13                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-14 NOT = SPACE
               MOVE 'Day of month'            TO WS-HDR
               MOVE WS-X12-14                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 107
           IF WS-X12-15 NOT = SPACE
               MOVE '107'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Percent'                 TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !IT1
      *    IT1~00000000001~288~EA~25.51833~~PU~000000023180581.
       1300-UNSTRING-IT1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22 WS-X12-23 WS-X12-24 WS-X12-25
                    WS-X12-26.

           ADD 1                              TO WS-IT1-CNT.
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-IT1-SW = SPACE
               MOVE 'N'                       TO WS-IT1-SW
               MOVE 'IT1'                     TO WS-HDR
               MOVE 'Baseline item data (invoice)' TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Quantity invoiced'       TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-04 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Unit price'              TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 639
           IF WS-X12-06 NOT = SPACE
               MOVE '639'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           IF WS-X12-07 NOT = SPACE
               MOVE WS-X12-07                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-08 NOT = SPACE
               MOVE WS-X12-08                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-09 NOT = SPACE
               MOVE WS-X12-09                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-10 NOT = SPACE
               MOVE WS-X12-10                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-11 NOT = SPACE
               MOVE WS-X12-11                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-12 NOT = SPACE
               MOVE WS-X12-12                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-13 NOT = SPACE
               MOVE WS-X12-13                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-14 NOT = SPACE
               MOVE WS-X12-14                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-15 NOT = SPACE
               MOVE WS-X12-15                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-16 NOT = SPACE
               MOVE WS-X12-16                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-17 NOT = SPACE
               MOVE WS-X12-17                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-18 NOT = SPACE
               MOVE WS-X12-18                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-19 NOT = SPACE
               MOVE WS-X12-19                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-20 NOT = SPACE
               MOVE WS-X12-20                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-21 NOT = SPACE
               MOVE WS-X12-21                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-22 NOT = SPACE
               MOVE WS-X12-22                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-23 NOT = SPACE
               MOVE WS-X12-23                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-24 NOT = SPACE
               MOVE WS-X12-24                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-25 NOT = SPACE
               MOVE WS-X12-25                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-26 NOT = SPACE
               MOVE WS-X12-26                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.

      *    !JIT
      *    JIT*120*1100~
       1300-UNSTRING-JIT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-JIT-SW = SPACE
               MOVE 'N'                       TO WS-JIT-SW
               MOVE 'JIT'                     TO WS-HDR
               MOVE 'Just-in-time schedule'   TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Quantity'                    TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Time'                        TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !J2X
      *    J2X**F*GLASS ASSY-FR DOOR,L.
       1300-UNSTRING-J2X.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'J2X'                         TO WS-HDR.
           MOVE 'Infinity item description'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 349
           IF WS-X12-03 NOT = SPACE
               MOVE '349'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Item description'        TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !LIN
      *    LIN~~BP~8A83 7421411 AB~PO~111111.
       1300-UNSTRING-LIN.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22 WS-X12-23 WS-X12-24 WS-X12-25
                    WS-X12-26 WS-X12-27 WS-X12-28 WS-X12-29 WS-X12-30
                    WS-X12-31 WS-X12-32.

           ADD 1                              TO WS-LIN-CNT.
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-LIN-SW = SPACE
               MOVE 'N'                       TO WS-LIN-SW
               MOVE 'LIN'                     TO WS-HDR
               MOVE 'Item identification'     TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Identification'          TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           MOVE WS-X12-03                     TO WS-HOLD-2.
           PERFORM 1300-PROCESS-LIN-235.
           MOVE WS-X12-04                     TO WS-HOLD-48.
           PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-05 NOT = SPACE
               MOVE WS-X12-05                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-06 NOT = SPACE
               MOVE WS-X12-06                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-07 NOT = SPACE
               MOVE WS-X12-07                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-08 NOT = SPACE
               MOVE WS-X12-08                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-09 NOT = SPACE
               MOVE WS-X12-09                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-10 NOT = SPACE
               MOVE WS-X12-10                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-11 NOT = SPACE
               MOVE WS-X12-11                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-12 NOT = SPACE
               MOVE WS-X12-12                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-13 NOT = SPACE
               MOVE WS-X12-13                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-14 NOT = SPACE
               MOVE WS-X12-14                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-15 NOT = SPACE
               MOVE WS-X12-15                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-16 NOT = SPACE
               MOVE WS-X12-16                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-17 NOT = SPACE
               MOVE WS-X12-17                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-18 NOT = SPACE
               MOVE WS-X12-18                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-19 NOT = SPACE
               MOVE WS-X12-19                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-20 NOT = SPACE
               MOVE WS-X12-20                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-21 NOT = SPACE
               MOVE WS-X12-21                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-22 NOT = SPACE
               MOVE WS-X12-22                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-23 NOT = SPACE
               MOVE WS-X12-23                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-24 NOT = SPACE
               MOVE WS-X12-24                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-25 NOT = SPACE
               MOVE WS-X12-25                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-26 NOT = SPACE
               MOVE WS-X12-26                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-27 NOT = SPACE
               MOVE WS-X12-27                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-28 NOT = SPACE
               MOVE WS-X12-28                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-29 NOT = SPACE
               MOVE WS-X12-29                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-30 NOT = SPACE
               MOVE WS-X12-30                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-31 NOT = SPACE
               MOVE WS-X12-31                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-32 NOT = SPACE
               MOVE WS-X12-32                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.

       1300-PROCESS-LIN-235.
           MOVE '235'                         TO WS-HOLD-SEGMENT.
           MOVE WS-HOLD-2                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.

       1300-PROCESS-LIN-234.
           MOVE 'Product/Service id'          TO WS-HDR.
           MOVE WS-HOLD-48                    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !LE   !LS
      *    LE*A
       1300-UNSTRING-LE-LS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE WS-X12-01                     TO WS-HDR.
           IF WS-X12-01 = 'LE'
               MOVE 'Loop trailer'            TO WS-VALUE.
           IF WS-X12-01 = 'LS'
               MOVE 'Loop header'             TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Loop identifier code'        TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !LX
      *    LX*1.
       1300-UNSTRING-LX.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'LX'                          TO WS-HDR.
           MOVE 'Assigned number'             TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Assigned number'             TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !MAN
      *    MAN*PB*WH160SPIN VF170V01L.
       1300-UNSTRING-MAN.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'MAN'                         TO WS-HDR.
           MOVE 'Marks and numbers'           TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 88
           MOVE '88'                          TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Marks and numbers'           TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Marks and numbers'       TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 88
           IF WS-X12-05 NOT = SPACE
               MOVE '88'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Marks and numbers'       TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Marks and numbers'       TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !MEA
      *    MEA*PD*G*510*LB~
       1300-UNSTRING-MEA.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'MEA'                         TO WS-HDR.
           MOVE 'Measurements'                TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 737
           IF WS-X12-02 NOT = SPACE
               MOVE '737'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 738
           IF WS-X12-03 NOT = SPACE
               MOVE '738'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Measurement value'       TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Range minimum'           TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Range maximum'           TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 935
           IF WS-X12-08 NOT = SPACE
               MOVE '935'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 936
           IF WS-X12-09 NOT = SPACE
               MOVE '936'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 752
           IF WS-X12-10 NOT = SPACE
               MOVE '752'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1373
           IF WS-X12-11 NOT = SPACE
               MOVE '1373'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !MIT
      *    MIT*1*VAN Migration*80*60.
       1300-UNSTRING-MIT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'MIT'                         TO WS-HDR.
           MOVE 'Message identification'      TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference identification'    TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Page width'              TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Page length lines'       TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !MSG
      *    MSG*Dear Valued Supplier, This notification is to
       1300-UNSTRING-MSG.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Printer carriage control'   TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Advance lines before print' TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !MTX
      *    MTX~GEN~in FCA US's order in accordance to the
       1300-UNSTRING-MTX.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
      *    data element 363
           IF WS-X12-02 NOT = SPACE
               MOVE '363'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 934
           IF WS-X12-05 NOT = SPACE
               MOVE '934'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !NM1
      *    NM1*PR*2*TMMTX~
       1300-UNSTRING-NM1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'NM1'                         TO WS-HDR.
           MOVE 'Individual or organization name'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           MOVE '98'                          TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 1065
           MOVE '1065'                        TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Last name or organization'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'First name'              TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Middle name'             TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Prefix'                  TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Suffix'                  TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 66
           IF WS-X12-09 NOT = SPACE
               MOVE '66'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Identification code'     TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 706
           IF WS-X12-11 NOT = SPACE
               MOVE '706'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           IF WS-X12-12 NOT = SPACE
               MOVE '98'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !NTE
      *    NTE*PAY*SUBJECT TO TERMS OF AGREEMENT BE
       1300-UNSTRING-NTE.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
      *    data element 363
           IF WS-X12-02 NOT = SPACE
               MOVE '363'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Description'                 TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !N1
      *    N1~ST~~92~AP20A
       1300-UNSTRING-N1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-N1-SW = SPACE
               MOVE 'N'                       TO WS-N1-SW
               MOVE 'N1'                      TO WS-HDR
               MOVE 'Name identification'     TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           MOVE '98'                          TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Name'                    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 66
           IF WS-X12-04 NOT = SPACE
               MOVE '66'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Identification code'     TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 706
           IF WS-X12-06 NOT = SPACE
               MOVE '706'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           IF WS-X12-07 NOT = SPACE
               MOVE '98'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !N2
      *    N2*HONDA OF AMERICA, MFG.~
       1300-UNSTRING-N2.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-N2-SW = SPACE
               MOVE 'N'                       TO WS-N2-SW
               MOVE 'N2'                      TO WS-HDR
               MOVE 'Additional name information' TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Name'                        TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Name'                    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !N3
      *    N3*1312 RUSSELL CAVE ROAD~
       1300-UNSTRING-N3.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-N3-SW = SPACE
               MOVE 'N'                       TO WS-N3-SW
               MOVE 'N3'                      TO WS-HDR
               MOVE 'Address information'     TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Address information'         TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    audit address field
           MOVE ZERO                          TO WS-TALLY.
           INSPECT WS-X12-02 TALLYING WS-TALLY
               FOR ALL WS-COMPONENT-SEP.
           IF WS-TALLY > ZERO
               MOVE SPACE                     TO X12OUT-RCD
               STRING '   $$ component separator ' DELIMITED BY SIZE
                      WS-COMPONENT-SEP           DELIMITED BY SIZE
                      ' found in N3 segment' DELIMITED BY SIZE
                      INTO X12OUT-RCD
               ADD 1                          TO WS-ISSUE-CNT
               PERFORM 3100-WRITE-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Address information'     TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.


      *    !N4
      *    N4*LEXINGTON*KY*40505*USA~
       1300-UNSTRING-N4.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-N4-SW = SPACE
               MOVE 'N'                       TO WS-N4-SW
               MOVE 'N4'                      TO WS-HDR
               MOVE 'Geographic location'     TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'City name'               TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'State or province code'  TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Postal code'             TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Country code'            TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-06 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !N9
      *    N9*VR*1119904.
       1300-UNSTRING-N9.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-N9-SW = SPACE
               MOVE 'N'                       TO WS-N9-SW
               MOVE 'N9'                      TO WS-HDR
               MOVE 'Reference identification'   TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           MOVE '128'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Reference id'            TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Free-form description'   TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 623
           IF WS-X12-07 NOT = SPACE
               MOVE '623'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Reference identifier'    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !OTI
      *    OTI*TA*SI*01467718***20181031*1716***856~
       1300-UNSTRING-OTI.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'OTI'                         TO WS-HDR.
           MOVE 'Original tran identification'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 110
           MOVE '110'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           MOVE '128'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference id'                TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Application senders cd'  TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Application receiver cd' TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Group control nbr'       TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Transaction set control nbr' TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 143
           IF WS-X12-11 NOT = SPACE
               MOVE '143'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 480
           IF WS-X12-12 NOT = SPACE
               MOVE '480'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 353
           IF WS-X12-13 NOT = SPACE
               MOVE '353'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 640
           IF WS-X12-14 NOT = SPACE
               MOVE '640'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 346
           IF WS-X12-15 NOT = SPACE
               MOVE '346'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 306
           IF WS-X12-16 NOT = SPACE
               MOVE '306'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-16                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 305
           IF WS-X12-17 NOT = SPACE
               MOVE '305'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-17                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 641
           IF WS-X12-18 NOT = SPACE
               MOVE '641'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-18                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !PER
      *    PER~EX~PARKER, DARREN~TE~313-322-0189.
       1300-UNSTRING-PER.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-PER-SW = SPACE
               MOVE 'N'                       TO WS-PER-SW
               MOVE 'PER'                     TO WS-HDR
               MOVE 'Admin communications contact' TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 366
           MOVE '366'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Name'                    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 365
           IF WS-X12-04 NOT = SPACE
               MOVE '365'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Communication nbr'       TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 365'
           IF WS-X12-06 NOT = SPACE
               MOVE '365'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Communication nbr'       TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 365
           IF WS-X12-08 NOT = SPACE
               MOVE '365'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Communication nbr'       TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Contact inquiry reference' TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !PID
      *    PID*F*08***GLASS SUN ROOF S SIA.
       1300-UNSTRING-PID.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PID'                         TO WS-HDR.
           MOVE 'Product/Item description'     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 349
           MOVE '349'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 750
           IF WS-X12-03 NOT = SPACE
               MOVE '750'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-04 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Product description code'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 752
           IF WS-X12-07 NOT = SPACE
               MOVE '752'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1073
           IF WS-X12-09 NOT = SPACE
               MOVE '1073'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Language code'           TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !PKG
      *    PKG*S*35*AB*KG.
       1300-UNSTRING-PKG.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PKG'                         TO WS-HDR.
           MOVE 'Marking, Packaging, Loading' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 349
           IF WS-X12-02 NOT = SPACE
               MOVE '349'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 753
           IF WS-X12-03 NOT = SPACE
               MOVE '753'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-04 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Packaging description code'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 400
           IF WS-X12-07 NOT = SPACE
               MOVE '400'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !POC
      *    POC|001|DI|2|2|EA|||BP|9827539|||PD|CAB GLASS|VP|119635.
       1300-UNSTRING-POC.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22 WS-X12-23 WS-X12-24 WS-X12-25
                    WS-X12-26 WS-X12-27 WS-X12-28.

           ADD 1                              TO WS-POC-CNT.
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'POC'                         TO WS-HDR.
           MOVE 'Line item change'            TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 670
           MOVE '670'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Quantity ordered'        TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Quantity left to receive'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Unit price'              TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 639
           IF WS-X12-08 NOT = SPACE
               MOVE '639'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           IF WS-X12-09 NOT = SPACE
               MOVE WS-X12-09                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-10 NOT = SPACE
               MOVE WS-X12-10                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-11 NOT = SPACE
               MOVE WS-X12-11                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-12 NOT = SPACE
               MOVE WS-X12-12                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-13 NOT = SPACE
               MOVE WS-X12-13                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-14 NOT = SPACE
               MOVE WS-X12-14                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-15 NOT = SPACE
               MOVE WS-X12-15                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-16 NOT = SPACE
               MOVE WS-X12-16                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-17 NOT = SPACE
               MOVE WS-X12-17                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-18 NOT = SPACE
               MOVE WS-X12-18                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-19 NOT = SPACE
               MOVE WS-X12-19                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-20 NOT = SPACE
               MOVE WS-X12-20                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-21 NOT = SPACE
               MOVE WS-X12-21                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-22 NOT = SPACE
               MOVE WS-X12-22                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-23 NOT = SPACE
               MOVE WS-X12-23                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-24 NOT = SPACE
               MOVE WS-X12-24                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-25 NOT = SPACE
               MOVE WS-X12-25                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-26 NOT = SPACE
               MOVE WS-X12-26                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-27 NOT = SPACE
               MOVE WS-X12-27                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-28 NOT = SPACE
               MOVE WS-X12-28                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.

      *    !PRF
      *    PRF*65851685-6463888~
       1300-UNSTRING-PRF.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PRF'                         TO WS-HDR.
           MOVE 'Purchase order reference'    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Purchase order number'       TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Release number'          TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Change order sequence nbr'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Contract number'         TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 92
           IF WS-X12-08 NOT = SPACE
               MOVE '92'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !PRR
      *    PRR*1***ZQ *WATER/COOLANT ENTERING/LEAKING.
       1300-UNSTRING-PRR.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PRR'                         TO WS-HDR.
           MOVE 'Problem report'              TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-03 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Complaint code'          TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-07 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1233
           IF WS-X12-09 NOT = SPACE
               MOVE '1233'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-10 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1234
           IF WS-X12-12 NOT = SPACE
               MOVE '1234'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !PRS
      *    PRS*4~
       1300-UNSTRING-PRS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PRS'                         TO WS-HDR.
           MOVE 'Part release status'         TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 682
           MOVE '682'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !PO1
      *    PO1*00000000001*5*EA*137.14**BP*R44-6059-5~
       1300-UNSTRING-PO1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22 WS-X12-23 WS-X12-24 WS-X12-25
                    WS-X12-26.

           ADD 1                              TO WS-PO1-CNT.
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PO1'                         TO WS-HDR.
           MOVE 'Baseline item data'           TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Quantity ordered'        TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-04 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Unit price'              TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 639
           IF WS-X12-06 NOT = SPACE
               MOVE '639'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           IF WS-X12-07 NOT = SPACE
               MOVE WS-X12-07                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-08 NOT = SPACE
               MOVE WS-X12-08                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-09 NOT = SPACE
               MOVE WS-X12-09                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-10 NOT = SPACE
               MOVE WS-X12-10                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-11 NOT = SPACE
               MOVE WS-X12-11                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-12 NOT = SPACE
               MOVE WS-X12-12                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-13 NOT = SPACE
               MOVE WS-X12-13                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-14 NOT = SPACE
               MOVE WS-X12-14                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-15 NOT = SPACE
               MOVE WS-X12-15                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-16 NOT = SPACE
               MOVE WS-X12-16                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-17 NOT = SPACE
               MOVE WS-X12-17                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-18 NOT = SPACE
               MOVE WS-X12-18                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-19 NOT = SPACE
               MOVE WS-X12-19                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-20 NOT = SPACE
               MOVE WS-X12-20                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-21 NOT = SPACE
               MOVE WS-X12-21                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-22 NOT = SPACE
               MOVE WS-X12-22                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-23 NOT = SPACE
               MOVE WS-X12-23                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-24 NOT = SPACE
               MOVE WS-X12-24                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-25 NOT = SPACE
               MOVE WS-X12-25                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-26 NOT = SPACE
               MOVE WS-X12-26                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.

      *    !PO4
      *    PO4**1*PC.
       1300-UNSTRING-PO4.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'PO4'                         TO WS-HDR.
           MOVE 'Item physical details'        TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Pack'                    TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Size'                    TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-04 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 103
           IF WS-X12-05-1 NOT = SPACE
               MOVE '103A'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-05-1               TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05-2 NOT = SPACE
               MOVE '103B'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-05-2               TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Weight qualifier'        TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Gross weight per pack'   TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-08 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Gross volume per pack'   TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-10 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Length'                  TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Width'                   TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-13 NOT = SPACE
               MOVE 'Height'                  TO WS-HDR
               MOVE WS-X12-13                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-14 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-15 NOT = SPACE
               MOVE 'Inner pack'              TO WS-HDR
               MOVE WS-X12-15                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 752
           IF WS-X12-16 NOT = SPACE
               MOVE '752'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-16                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-17 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-17                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-18 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-18                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-19 NOT = SPACE
               MOVE 'Number'                  TO WS-HDR
               MOVE WS-X12-19                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !QTY
      *    QTY*CS*21783*DH.
       1300-UNSTRING-QTY.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'QTY'                         TO WS-HDR.
           MOVE 'Quantity'                    TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 673
           MOVE '673'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Free-form message'       TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !RCD
      *    RCD**1*PC***0*PC*01*0*PC*02*0*PC*03*0*PC*08~
       1300-UNSTRING-RCD.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22.

           ADD 1                              TO WS-RCD-CNT.
           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'RCD'                         TO WS-HDR.
           MOVE 'Receiving conditions'        TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Quantity received or accepted' TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Quantity units returned' TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Quantity in question'    TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 412
           IF WS-X12-09 NOT = SPACE
               MOVE '412'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Quantity in question'    TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 412
           IF WS-X12-12 NOT = SPACE
               MOVE '412'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-12                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-13 NOT = SPACE
               MOVE 'Quantity in question'    TO WS-HDR
               MOVE WS-X12-13                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-14 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-14                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 412
           IF WS-X12-15 NOT = SPACE
               MOVE '412'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Quantity in question'    TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-17 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-17                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 412
           IF WS-X12-18 NOT = SPACE
               MOVE '412'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-18                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-19 NOT = SPACE
               MOVE 'Quantity in question'    TO WS-HDR
               MOVE WS-X12-19                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-20 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-20                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 412
           IF WS-X12-21 NOT = SPACE
               MOVE '412'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-21                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-22 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-22                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !REF
      *    REF~DK~PK
       1300-UNSTRING-REF.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-REF-SW = SPACE
               MOVE 'N'                       TO WS-REF-SW
               MOVE 'REF'                     TO WS-HDR
               MOVE 'Reference identification'   TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           MOVE '128'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Reference id'            TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Reference description'   TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Reference identifier'    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE ZERO                          TO WS-TALLY.
           INSPECT WS-X12-05 TALLYING WS-TALLY FOR ALL WS-COMPONENT-SEP.
           IF WS-TALLY > ZERO
               MOVE 'Y'                       TO WS-COMPONENT-HDR-SW
               PERFORM 1300-REF-COMPONENTS
               MOVE SPACE                     TO WS-COMPONENT-HDR-SW.

       1300-REF-COMPONENTS.
           MOVE SPACE                         TO WS-COMPONENT-FIELDS.
           UNSTRING WS-X12-05       DELIMITED BY WS-COMPONENT-SEP
               INTO WS-COMP-01  WS-COMP-02  WS-COMP-03
                    WS-COMP-04  WS-COMP-05  WS-COMP-06.
      *    data element 128
           MOVE '128'                         TO WS-HOLD-SEGMENT.
           MOVE WS-COMP-01                    TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-COMP-02 NOT = SPACE
               MOVE '   Reference id'         TO WS-HDR
               MOVE WS-COMP-02                TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-COMP-03 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-COMP-03                TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT
               IF WS-COMP-04 NOT = SPACE
                   MOVE '   Reference id'     TO WS-HDR
                   MOVE WS-COMP-04            TO WS-VALUE
                   PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-COMP-05 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-COMP-05                TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT
               IF WS-COMP-06 NOT = SPACE
                   MOVE '   Reference id'     TO WS-HDR
                   MOVE WS-COMP-06            TO WS-VALUE
                   PERFORM 3000-BUILD-X12OUT.

      *    !REP
      *    REP*1*PN*727525AA0A.
       1300-UNSTRING-REP.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'REP'                         TO WS-HDR.
           MOVE 'Repair action'               TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           IF WS-X12-03 NOT = SPACE
               MOVE WS-X12-03                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-04 NOT = SPACE
               MOVE WS-X12-04                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-05 NOT = SPACE
               MOVE WS-X12-05                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-06 NOT = SPACE
               MOVE WS-X12-06                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 559
           IF WS-X12-07 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1226
           IF WS-X12-09 NOT = SPACE
               MOVE '1226'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-11 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1227
           IF WS-X12-13 NOT = SPACE
               MOVE '1227'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           IF WS-X12-14 NOT = SPACE
               MOVE WS-X12-14                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-15 NOT = SPACE
               MOVE WS-X12-15                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 1226
           IF WS-X12-16 NOT = SPACE
               MOVE '1226'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-16                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-17 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-17                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-18 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-18                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-19 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-19                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-20 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-20                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-21 NOT = SPACE
               MOVE 'Authorization identification'   TO WS-HDR
               MOVE WS-X12-21                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !RMR
      *    RMR~BM~1457300~~-.31~-.31.
       1300-UNSTRING-RMR.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-RMR-SW = SPACE
               MOVE 'N'                       TO WS-RMR-SW
               MOVE 'RMR'                     TO WS-HDR
               MOVE 'Remittance advice AR open item ref' TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           IF WS-X12-02 NOT = SPACE
               MOVE '128'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Reference id'            TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 482
           IF WS-X12-04 NOT = SPACE
               MOVE '482'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 426
           IF WS-X12-08 NOT = SPACE
               MOVE '426'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !RMT
      *    RMT*IX*833015AA0A*16.1675*4850.25*****NO
       1300-UNSTRING-RMT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-RMT-SW = SPACE
               MOVE 'N'                       TO WS-RMT-SW
               MOVE 'RMT'                     TO WS-HDR
               MOVE 'Remittance advice'       TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 128
           MOVE '128'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference id'                TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 426
           IF WS-X12-10 NOT = SPACE
               MOVE '426'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !SAC
      *    SAC*C*I700***53496****EA*18.
       1300-UNSTRING-SAC.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'SAC'                         TO WS-HDR.
           MOVE 'SPAC service, promotion, allowance, charge'
                                              TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 248
           MOVE '248'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 1300
           IF WS-X12-03 NOT = SPACE
               MOVE '1300'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           IF WS-X12-04 NOT = SPACE
               MOVE '559'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1301
           IF WS-X12-05 NOT = SPACE
               MOVE '1301'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Amount'                  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 378
           IF WS-X12-07 NOT = SPACE
               MOVE '378'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Percent'                 TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Rate'                    TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-10 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 331
           IF WS-X12-13 NOT = SPACE
               MOVE '331'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-14 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-14                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-15 NOT = SPACE
               MOVE 'Option number'           TO WS-HDR
               MOVE WS-X12-15                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 819
           IF WS-X12-17 NOT = SPACE
               MOVE '819'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-17                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !SCH
      *    SCH*5*EA***010*20181208~
       1300-UNSTRING-SCH.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'SCH'                         TO WS-HDR.
           MOVE 'Line item schedule'          TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Quantity'                    TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           MOVE '355'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 98
           IF WS-X12-04 NOT = SPACE
               MOVE '98'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Name'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           MOVE '374'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-06                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Date'                        TO WS-HDR.
           MOVE WS-X12-07                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-09 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Request reference number'   TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-13 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-13                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !SDP
      *    SDP*Y*Y.
       1300-UNSTRING-SDP.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'SDP'                         TO WS-HDR.
           MOVE 'Ship delivery pattern'       TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 678
           MOVE '678'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 679
           MOVE '679'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 678
           IF WS-X12-04 NOT = SPACE
               MOVE '678'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 679
           IF WS-X12-05 NOT = SPACE
               MOVE '679'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 678
           IF WS-X12-06 NOT = SPACE
               MOVE '678'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 679
           IF WS-X12-07 NOT = SPACE
               MOVE '679'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 678
           IF WS-X12-08 NOT = SPACE
               MOVE '678'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 679
           IF WS-X12-09 NOT = SPACE
               MOVE '679'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !SE
      *    SE~144~0001
       1300-UNSTRING-SE.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'SE'                          TO WS-HDR.
           MOVE 'Transaction set trailer'     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Lines in ST-SE group'        TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Transaction set control nbr' TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !SHP
      *    SHP~02~+1430~011~180101~~181106
       1300-UNSTRING-SHP.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-SHP-SW = SPACE
               MOVE 'N'                       TO WS-SHP-SW
               MOVE 'SHP'                     TO WS-HDR
               MOVE 'Shipped/received information' TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 673
           IF WS-X12-02 NOT = SPACE
               MOVE '673'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 374
           IF WS-X12-04 NOT = SPACE
               MOVE '374'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Date'                    TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Time'                    TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !SLN
      *    SLN~1~~I~1~EA~~~~BP~68143440AA
       1300-UNSTRING-SLN.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16 WS-X12-17 WS-X12-18 WS-X12-19 WS-X12-20
                    WS-X12-21 WS-X12-22 WS-X12-23 WS-X12-24 WS-X12-25
                    WS-X12-26 WS-X12-27 WS-X12-28 WS-X12-29.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-SLN-SW = SPACE
               MOVE 'N'                       TO WS-SLN-SW
               MOVE 'SLN'                     TO WS-HDR
               MOVE 'Subline item detail'     TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Assigned identification'     TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 662
           MOVE '662'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Composite unit of measure'  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Unit price'              TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 639
           IF WS-X12-08 NOT = SPACE
               MOVE '639'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 662
           IF WS-X12-09 NOT = SPACE
               MOVE '662'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 235
           IF WS-X12-10 NOT = SPACE
               MOVE WS-X12-10                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-11 NOT = SPACE
               MOVE WS-X12-11                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-12 NOT = SPACE
               MOVE WS-X12-12                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-13 NOT = SPACE
               MOVE WS-X12-13                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-14 NOT = SPACE
               MOVE WS-X12-14                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-15 NOT = SPACE
               MOVE WS-X12-15                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-16 NOT = SPACE
               MOVE WS-X12-16                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-17 NOT = SPACE
               MOVE WS-X12-17                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-18 NOT = SPACE
               MOVE WS-X12-18                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-19 NOT = SPACE
               MOVE WS-X12-19                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-20 NOT = SPACE
               MOVE WS-X12-20                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-21 NOT = SPACE
               MOVE WS-X12-21                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-22 NOT = SPACE
               MOVE WS-X12-22                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-23 NOT = SPACE
               MOVE WS-X12-23                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-24 NOT = SPACE
               MOVE WS-X12-24                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-25 NOT = SPACE
               MOVE WS-X12-25                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-26 NOT = SPACE
               MOVE WS-X12-26                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-27 NOT = SPACE
               MOVE WS-X12-27                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.
      *    data element 235
           IF WS-X12-28 NOT = SPACE
               MOVE WS-X12-28                 TO WS-HOLD-2
               PERFORM 1300-PROCESS-LIN-235.
           IF WS-X12-29 NOT = SPACE
               MOVE WS-X12-29                 TO WS-HOLD-48
               PERFORM 1300-PROCESS-LIN-234.

      *    !SN1
      *    SN1**34*PC~
       1300-UNSTRING-SN1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'SN1'                         TO WS-HDR.
           MOVE 'Item detail (shipment)'      TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-02                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           MOVE 'Number of units shipped'     TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           MOVE '355'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Quantity shipped to date'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Quantity ordered'        TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-07 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Returnable container load code' TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 668
           IF WS-X12-09 NOT = SPACE
               MOVE '668'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !SSS
      *    SSS*C*AB*PP**0.09*3576**3.22.
       1300-UNSTRING-SSS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'SSS'                         TO WS-HDR.
           MOVE 'Special services'            TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 248
           MOVE '248'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 559
           MOVE '559'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-03                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 560
           MOVE '560'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-04                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Service marks and nbrs'  TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Allowance or charge rate'   TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Amount'                  TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Quantity'                TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Source subqualifier'     TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !ST
      *    ST~862~0001
       1300-UNSTRING-ST.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03.

           MOVE ZERO                          TO WS-HL-CNT.
           MOVE ZERO                          TO WS-LIN-CNT.
           MOVE ZERO                          TO WS-IT1-CNT.
           MOVE ZERO                          TO WS-POC-CNT.
           MOVE ZERO                          TO WS-PO1-CNT.
           MOVE ZERO                          TO WS-RCD-CNT.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'ST'                          TO WS-HDR.
           MOVE 'Transaction set header'      TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE WS-X12-02                     TO WS-HOLD-TRAN.
      *    data element 143
           MOVE '143'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Transaction set control nbr' TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.

      *    !TAX
      *    TAX*9-07-000013*SP*IA~
       1300-UNSTRING-TAX.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TAX'                         TO WS-HDR.
           MOVE 'Tax reference'               TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Tax identification nbr'      TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-03 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-05 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-07 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-09 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-11 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 441
           IF WS-X12-13 NOT = SPACE
               MOVE '441'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1179
           IF WS-X12-14 NOT = SPACE
               MOVE '1179'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !TA1
      *    TA1*PLT90*1~
       1300-UNSTRING-TA1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TA1'                         TO WS-HDR.
           MOVE 'Interchange acknowledgment'  TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange control nbr'     TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange date'            TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Interchange time'            TO WS-HDR.
           MOVE WS-X12-04                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I17
           MOVE 'I17'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-05                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
      *    data element I18
           MOVE 'I18'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-06                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.

      *    !TDS
      *    TDS*9106.
       1300-UNSTRING-TDS.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TDS'                         TO WS-HDR.
           MOVE 'Total monetary value summary'   TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Amount'                      TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Amount'                  TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Amount'                  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Amount'                  TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !TD1
      *    TD1*PLT90*1~
       1300-UNSTRING-TD1.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           IF WS-TD1-SW = SPACE
               MOVE 'N'                       TO WS-TD1-SW
               MOVE 'TD1'                     TO WS-HDR
               MOVE 'Carrier details - quantity and weight'
                                              TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 103
           IF WS-X12-02-1 NOT = SPACE
               MOVE '103A'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-02-1               TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-02-2 NOT = SPACE
               MOVE '103B'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-02-2               TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Lading quantity'         TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Commodity mode qualifier' TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Commodity code'          TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Lading description'      TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 187
           IF WS-X12-07 NOT = SPACE
               MOVE '187'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Weight'                  TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-09 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Volume'                  TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-11 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !TD3
      *    TD3*TL**MR1234~
       1300-UNSTRING-TD3.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TD3'                         TO WS-HDR.
           MOVE 'Carrier details - equipment' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 40
           IF WS-X12-02 NOT = SPACE
               MOVE '40'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Equipment initial'       TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Equipment number'        TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 187
           IF WS-X12-05 NOT = SPACE
               MOVE '187'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Weight'                  TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 355
           IF WS-X12-07 NOT = SPACE
               MOVE '355'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 102
           IF WS-X12-08 NOT = SPACE
               MOVE '102'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 407
           IF WS-X12-09 NOT = SPACE
               MOVE '407'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-09                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Seal number'             TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Equipment type'          TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !TD4
      *    TD4****FOR SHIPMENTS 150 LBS AND UNDER,~
       1300-UNSTRING-TD4.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TD4'                         TO WS-HDR.
           MOVE 'Carrier details - special handling' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 152
           IF WS-X12-02 NOT = SPACE
               MOVE '152'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 208
           IF WS-X12-03 NOT = SPACE
               MOVE '208'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Hazardous material class code' TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Description'             TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 1073
           IF WS-X12-06 NOT = SPACE
               MOVE '1073'                    TO WS-HOLD-SEGMENT
               MOVE WS-X12-06                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *    !TD5
      *    TD5**2*MWLL~
       1300-UNSTRING-TD5.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11 WS-X12-12 WS-X12-13 WS-X12-14 WS-X12-15
                    WS-X12-16.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TD5'                         TO WS-HDR.
           MOVE 'Carrier details - routing sequence' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 133
           IF WS-X12-02 NOT = SPACE
               MOVE '133'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-02                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 66
           IF WS-X12-03 NOT = SPACE
               MOVE '66'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-03                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Identification code'     TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 91
           IF WS-X12-05 NOT = SPACE
               MOVE '91'                      TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Routing'                 TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 368
           IF WS-X12-07 NOT = SPACE
               MOVE '368'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 309
           IF WS-X12-08 NOT = SPACE
               MOVE '309'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Location identifier'     TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 731
           IF WS-X12-10 NOT = SPACE
               MOVE '731'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-10                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 732
           IF WS-X12-11 NOT = SPACE
               MOVE '732'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-11                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-12 NOT = SPACE
               MOVE 'Transit time'            TO WS-HDR
               MOVE WS-X12-12                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 284
           IF WS-X12-13 NOT = SPACE
               MOVE '284'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-13                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 284
           IF WS-X12-14 NOT = SPACE
               MOVE '284'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-14                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 284
           IF WS-X12-15 NOT = SPACE
               MOVE '284'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-15                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-16 NOT = SPACE
               MOVE 'Country code'            TO WS-HDR
               MOVE WS-X12-16                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !TED
      *    TED*ZZZ*ASN is Valid~
       1300-UNSTRING-TED.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TED'                         TO WS-HDR.
           MOVE 'Technical error description' TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 647
           MOVE '647'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Free-form message'       TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 721
           IF WS-X12-04 NOT = SPACE
               MOVE '721'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Segment position in tran set' TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Element position in segment' TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-07 NOT = SPACE
               MOVE 'Data element reference nbr' TO WS-HDR
               MOVE WS-X12-07                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-08 NOT = SPACE
               MOVE 'Copy of bad data element  ' TO WS-HDR
               MOVE WS-X12-08                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Data element new content'   TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !TRN
      *    TRN~1~NVL101022858089.
       1300-UNSTRING-TRN.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TRN'                         TO WS-HDR.
           MOVE 'Trace'                       TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 481
           MOVE '481'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Reference identification'    TO WS-HDR.
           MOVE WS-X12-03                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Originating company ID'  TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-05 NOT = SPACE
               MOVE 'Reference identification'   TO WS-HDR
               MOVE WS-X12-05                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !TXI
      *    TXI*GS*1520.73*13~
       1300-UNSTRING-TXI.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04 WS-X12-05
                    WS-X12-06 WS-X12-07 WS-X12-08 WS-X12-09 WS-X12-10
                    WS-X12-11.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE 'TXI'                         TO WS-HDR.
           MOVE 'Tax information'             TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
      *    data element 963
           MOVE '963'                         TO WS-HOLD-SEGMENT.
           MOVE WS-X12-02                     TO WS-HOLD-CODE.
           PERFORM 1300-EVALUATE-ELEMENT.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Monetary amount'         TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-04 NOT = SPACE
               MOVE 'Percent'                 TO WS-HDR
               MOVE WS-X12-04                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 955
           IF WS-X12-05 NOT = SPACE
               MOVE '955'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-05                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-06 NOT = SPACE
               MOVE 'Tax jurisdiction code'   TO WS-HDR
               MOVE WS-X12-06                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 441
           IF WS-X12-07 NOT = SPACE
               MOVE '441'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-07                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
      *    data element 662
           IF WS-X12-08 NOT = SPACE
               MOVE '662'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-08                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-09 NOT = SPACE
               MOVE 'Dollar basis for percent'   TO WS-HDR
               MOVE WS-X12-09                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-10 NOT = SPACE
               MOVE 'Tax identification nbr'  TO WS-HDR
               MOVE WS-X12-10                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-11 NOT = SPACE
               MOVE 'Assigned identification' TO WS-HDR
               MOVE WS-X12-11                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.

      *    !UIT
      *    UIT*EA~
       1300-UNSTRING-UIT.
           PERFORM 1800-SHOW-X12-OUT.
           INSPECT WS-X12-RCDS REPLACING ALL WS-EOR BY SPACE.
           MOVE SPACE                         TO WS-X12-FIELDS.
           UNSTRING WS-X12-RCDS               DELIMITED BY WS-DELIM
               INTO WS-X12-01 WS-X12-02 WS-X12-03 WS-X12-04.

           MOVE SPACE                         TO WS-EXPLAIN-FIELDS.
           MOVE WS-X12-01                     TO WS-HDR.
           MOVE 'Unit detail'                 TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           MOVE 'Composite unit of measure'   TO WS-HDR.
           MOVE WS-X12-02                     TO WS-VALUE.
           PERFORM 3000-BUILD-X12OUT.
           IF WS-X12-03 NOT = SPACE
               MOVE 'Unit price'              TO WS-HDR
               MOVE WS-X12-03                 TO WS-VALUE
               PERFORM 3000-BUILD-X12OUT.
      *    data element 639
           IF WS-X12-04 NOT = SPACE
               MOVE '639'                     TO WS-HOLD-SEGMENT
               MOVE WS-X12-04                 TO WS-HOLD-CODE
               PERFORM 1300-EVALUATE-ELEMENT
               PERFORM 3000-BUILD-X12OUT.

      *---------------------------------------


      *---------------------------------------
      *    loop through PARM01 and match element code and number
      *    to a description
      *---------------------------------------
       1300-EVALUATE-ELEMENT.
           MOVE SPACE                         TO WS-HDR.
           STRING '?? '                       DELIMITED BY SIZE
                  WS-HOLD-SEGMENT             DELIMITED BY SIZE
                  INTO WS-HDR.
           MOVE SPACE                         TO WS-VALUE.
           IF WS-HOLD-CODE = SPACE
               STRING '$$ missing but mandatory '
                                              DELIMITED BY SIZE
                      WS-HOLD-SEGMENT         DELIMITED BY SIZE
                      INTO WS-VALUE
           ELSE
               STRING '?? '                   DELIMITED BY SIZE
                      WS-HOLD-CODE            DELIMITED BY SIZE
                      ' element '             DELIMITED BY SIZE
                      WS-HOLD-SEGMENT         DELIMITED BY SIZE
                      INTO WS-VALUE.
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > WS-PARM01-MAX
               IF WS-P1-ELEMENT(WS-SUB2) = WS-HOLD-SEGMENT
                 IF WS-P1-CODE(WS-SUB2) = SPACE
                   IF WS-COMPONENT-HDR-SW = 'Y'
                       MOVE SPACE               TO WS-HDR
                       MOVE WS-P1-DESC(WS-SUB2) TO WS-HDR(4: )
                   ELSE
                       MOVE WS-P1-DESC(WS-SUB2) TO WS-HDR
                   END-IF
                 ELSE
                 IF WS-P1-CODE(WS-SUB2) = WS-HOLD-CODE
                     MOVE WS-P1-DESC(WS-SUB2) TO WS-VALUE
                     MOVE WS-PARM01-MAX       TO WS-SUB2
                 END-IF
                 END-IF
               END-IF
           END-PERFORM.
           IF WS-VALUE(1: 10) = '$$ missing'
               ADD 1                          TO WS-ISSUE-CNT
           ELSE
           IF WS-HDR(1: 3) = '?? '
               ADD 1                          TO WS-QUESTION-CNT
               PERFORM 1400-TRACK-HDR
           ELSE
           IF WS-VALUE(1: 3) = '?? '
               ADD 1                          TO WS-QUESTION-CNT
               PERFORM 1400-TRACK-CODE.

      *---------------------------------------
      *    add unmatched codes to table and list at end
      *---------------------------------------
       1400-TRACK-HDR.
           PERFORM VARYING WS-SUB3 FROM 1 BY 1
               UNTIL WS-SUB3 > 11
               IF WS-SUB3 > 10
                   MOVE 'Y'                   TO WS-ELE-OVER10-SW
               ELSE
               IF WS-HDR = WS-HI-30(WS-SUB3)
                   MOVE 11                    TO WS-SUB3
               ELSE
               IF WS-HI-30(WS-SUB3) = SPACE
                   MOVE WS-HDR                TO WS-HI-30(WS-SUB3)
                   MOVE 11                    TO WS-SUB3
               END-IF
               END-IF
               END-IF
           END-PERFORM.

      *---------------------------------------
      *    add unmatched codes to table and list at end
      *---------------------------------------
       1400-TRACK-CODE.
           PERFORM VARYING WS-SUB3 FROM 1 BY 1
               UNTIL WS-SUB3 > 31
               IF WS-SUB3 > 30
                   MOVE 'Y'                   TO WS-CODE-OVER30-SW
               ELSE
               IF WS-VALUE = WS-CI-47(WS-SUB3)
                   MOVE 31                    TO WS-SUB3
               ELSE
               IF WS-CI-47(WS-SUB3) = SPACE
                   MOVE WS-VALUE              TO WS-CI-47(WS-SUB3)
                   MOVE 31                    TO WS-SUB3
               END-IF
               END-IF
               END-IF
           END-PERFORM.



       1800-SHOW-X12-OUT.
           PERFORM VARYING WS-SUB2 FROM 1 BY 1
               UNTIL WS-SUB2 > 5
               IF WS-X12-RCD(WS-SUB2) NOT = SPACE
                   MOVE WS-X12-RCD(WS-SUB2)   TO X12OUT-RCD
                   PERFORM 3100-WRITE-X12OUT
               END-IF
           END-PERFORM.

       2600-DETERMINE-EOR-ISA.
           PERFORM 2600-INITIAL-X12-IEA-LOOP
               VARYING WS-SUB2 FROM 80 BY -1
               UNTIL WS-SUB2 < 3.
           IF WS-EOR NOT = WS-EOR-ISA
               MOVE WS-EOR-ISA                TO WS-EOR
               PERFORM 2600-SHOW-EOR.
           IF X12IN-RCD(4: 1) NOT = WS-DELIM
               MOVE X12IN-RCD(4: 1)           TO WS-DELIM
               DISPLAY '**** ISA Delimiter         ' WS-DELIM.

       2600-DETERMINE-EOR-UNB.
           PERFORM 2600-INITIAL-X12-UNZ-LOOP
               VARYING WS-SUB2 FROM 80 BY -1
               UNTIL WS-SUB2 < 3.
           IF WS-EOR NOT = WS-EOR-UNB
               MOVE WS-EOR-UNB                TO WS-EOR
               PERFORM 2600-SHOW-EOR.
           IF X12IN-RCD(4: 1) NOT = WS-DELIM
               MOVE X12IN-RCD(4: 1)           TO WS-DELIM
               DISPLAY '**** UNB Delimiter         ' WS-DELIM.

       2600-INITIAL-X12-IEA-LOOP.
           IF X12IN-RCD(WS-SUB2: 1) NOT = SPACE
               MOVE X12IN-RCD(WS-SUB2: 1)     TO WS-EOR-ISA
               MOVE ZERO                      TO WS-SUB2.

       2600-INITIAL-X12-UNZ-LOOP.
           IF X12IN-RCD(WS-SUB2: 1) NOT = SPACE
               MOVE X12IN-RCD(WS-SUB2: 1)     TO WS-EOR-UNB
               MOVE ZERO                      TO WS-SUB2.

       2600-SHOW-EOR.
           IF WS-X12-SW = 'X'
             IF WS-EOR-ISA = SPACE
                 DISPLAY '**** X12SHOW ISA end-of-record delimiter'
                 DISPLAY '**** not determined'
                 DISPLAY '**** terminating program'
                 MOVE 'Y'                     TO WS-END-X12IN-SW
             ELSE
             IF WS-EOR-ISA = WS-X22
                 DISPLAY '**** ISA EOR delimiter     x22'
             ELSE
             IF WS-EOR-ISA = WS-X0D
                 DISPLAY '**** ISA EOR delimiter     x0D'
             ELSE
             IF WS-EOR-ISA = WS-X1C
                 DISPLAY '**** ISA EOR delimiter     x1C'
             ELSE
             IF WS-EOR-ISA = WS-X15
                 DISPLAY '**** ISA EOR delimiter     x15'
             ELSE
                 DISPLAY '**** ISA EOR delimiter     ' WS-EOR-ISA.

           IF WS-X12-SW = 'E'
             IF WS-EOR-UNB = SPACE
                 DISPLAY '**** X12SHOW UNB end-of-record delimiter'
                 DISPLAY '**** not determined'
                 DISPLAY '**** terminating program'
                 MOVE 'Y'                     TO WS-END-X12IN-SW
             ELSE
                 DISPLAY '**** UNB EOR delimiter     ' WS-EOR-UNB.

       3000-BUILD-X12OUT.
           IF WS-VALUE = SPACE
               MOVE '$$ missing but mandatory'   TO WS-VALUE
               ADD 1                          TO WS-ISSUE-CNT.
           MOVE WS-EXPLAIN-FIELDS             TO X12OUT-RCD.
           PERFORM 3100-WRITE-X12OUT.

       3100-WRITE-X12OUT.
           WRITE X12OUT-RECORD.
           IF WS-STAT = ZERO
               ADD 1                          TO WS-WRITE-X12OUT-CNT
           ELSE
               DISPLAY '**** X12SHOW write error on X12OUT'
               DISPLAY '**** File stat           ' WS-STAT
               MOVE 'Y'                       TO WS-END-X12IN-SW
               MOVE +3100                     TO WS-RETURN-CODE.

      ************************************ END X12SHOW
